angular.module("starter").controller("FanwallCommentController",function($scope){});angular.module("starter").controller("FanwallEditCommentController",function($scope,$rootScope,$stateParams,$translate,Fanwall,FanwallPost,Dialog,Picture,Loader){angular.extend($scope,{pageTitle:$translate.instant("Edit comment","fanwall"),form:{text:"",picture:"",date:null,}});FanwallPost.setValueId($stateParams.value_id);$scope.getCardDesign=function(){return Fanwall.cardDesign};$scope.getSettings=function(){return Fanwall.settings};$scope.picturePreview=function(){if($scope.form.picture.indexOf("/")===0){return IMAGE_URL+"images/application"+$scope.form.picture}
return $scope.form.picture};$scope.takePicture=function(){return Picture.takePicture().then(function(success){$scope.form.picture=success.image})};$scope.removePicture=function(){$scope.form.picture=""};$scope.clearForm=function(){$scope.form={text:"",picture:""}};$scope.canSend=function(){return($scope.form.text.length>0||$scope.form.picture.length>0)};$scope.sendComment=function(){var commentId=$scope.comment.id;var postId=$scope.comment.postId;if(!$scope.canSend()){Dialog.alert("Error","You must send at least a message or a picture.","OK",-1,"fanwall");return!1}
Loader.show();$scope.form.date=Math.round(Date.now()/1000);return FanwallPost.sendComment(postId,commentId,$scope.form).then(function(payload){Loader.hide();$rootScope.$broadcast("fanwall.refresh");$rootScope.$broadcast("fanwall.refresh.comments",{comments:payload.comments,postId:payload.postId});$scope.close()},function(payload){Loader.hide();Dialog.alert("Error",payload.message,"OK",-1,"fanwall")})};if($scope.comment!==undefined){$scope.form.text=$scope.comment.text.replace(/(<br( ?)(\/?)>)/gm,"\n");if($scope.comment.image.length>0){$scope.form.picture=$scope.comment.image}}});angular.module("starter").controller("FanwallNewController",function($scope,$rootScope,$session,$state,$stateParams,$translate,$q,Customer,Fanwall,FanwallPost,Dialog,Picture,Loader,Location,GoogleMaps,Popover,$timeout){angular.extend($scope,{pageTitle:$translate.instant("Create a post","fanwall"),form:{text:"",picture:"",date:null,location:{latitude:0,longitude:0,locationShort:""}},fetchingLocation:!1,shortLocation:"",popoverItems:[],actionsPopover:null,preference:"always",preferenceKey:"socialwall.location.preference"});FanwallPost.setValueId($stateParams.value_id);$scope.getCardDesign=function(){return Fanwall.cardDesign};$scope.getSettings=function(){return Fanwall.settings};$scope.locationIsDisabled=function(){return!Location.isEnabled};$scope.requestLocation=function(){Dialog.confirm("Error","We were unable to request your location.<br />Please check that the application is allowed to use the GPS and that your device GPS is on.",["TRY AGAIN","DISMISS"],-1,"location").then(function(success){if(success){Location.isEnabled=!0;Loader.show();Location.getLocation({timeout:30000,enableHighAccuracy:!1},!0).then(function(payload){Loader.hide();Dialog.alert("Success","We finally got you location","OK",2350,"fanwall");$scope.init()},function(){Loader.hide();Dialog.alert("Error","We were unable to request your location.<br />Please check that the application is allowed to use the GPS and that your device GPS is on.","OK",3700,"location")})}})};$scope.myAvatar=function(){if(Customer.customer&&Customer.customer.image&&Customer.customer.image.length>0){return IMAGE_URL+"images/customer"+Customer.customer.image}
return"./features/fanwall2/assets/templates/images/customer-placeholder.png"};$scope.picturePreview=function(){if($scope.form.picture.indexOf("/")===0){return IMAGE_URL+"images/application"+$scope.form.picture}
return $scope.form.picture};$scope.myName=function(){return Customer.customer.firstname+" "+Customer.customer.lastname};$scope.takePicture=function(){return Picture.takePicture().then(function(success){$scope.form.picture=success.image})};$scope.removePicture=function(){$scope.form.picture=""};$scope.clearForm=function(){$scope.form={text:"",picture:"",location:{latitude:0,longitude:0,locationShort:""}}};$scope.canSend=function(){return($scope.form.text.length>0||$scope.form.picture.length>0)};$scope.sendPost=function(){var postId=($scope.post!==undefined)?$scope.post.id:null;if($scope.fetchingLocation){Dialog.alert("Wait","Please wait while we are fetching your location.","OK",2350,"fanwall");return!1}
if(!$scope.canSend()){Dialog.alert("Error","You must send at least a message or a picture.","OK",-1,"fanwall");return!1}
Loader.show();$scope.form.date=Math.round(Date.now()/1000);return FanwallPost.sendPost(postId,$scope.form).then(function(payload){Loader.hide();$rootScope.$broadcast("fanwall.refresh");$scope.close()},function(payload){Loader.hide();Dialog.alert("Error",payload.message,"OK",-1,"fanwall")})};$scope.openActions=function($event){$scope.closeActions().then(function(){Popover.fromTemplateUrl("features/fanwall2/assets/templates/l1/modal/post/actions-popover.html",{scope:$scope}).then(function(popover){$scope.actionsPopover=popover;$scope.actionsPopover.show($event)})})};$scope.closeActions=function(){try{if($scope.actionsPopover){return $scope.actionsPopover.hide()}}catch(e){}
return $q.resolve()};$scope.changeLocationSettings=function(preference,reinit){$scope.preference=preference;$session.setItem($scope.preferenceKey,preference).then(function(value){if(reinit===!0){$scope.init()}}).catch(function(err){if(reinit===!0){$scope.init()}})};$scope.buildPopoverItems=function(){$scope.popoverItems=[];if(!$scope.locationIsDisabled()){$scope.popoverItems.push({label:$translate.instant("Locate me once","fanwall"),icon:"icon ion-android-locate",click:function(){$scope.closeActions().then(function(){$scope.changeLocationSettings("once",!0)})}});$scope.popoverItems.push({label:$translate.instant("Always ask","fanwall"),icon:"icon ion-help",click:function(){$scope.closeActions().then(function(){$scope.changeLocationSettings("ask",!0)})}});$scope.popoverItems.push({label:$translate.instant("Always locate me","fanwall"),icon:"icon ion-sb-location-on",click:function(){$scope.closeActions().then(function(){$scope.changeLocationSettings("always",!0)})}});$scope.popoverItems.push({label:$translate.instant("Never locate me","fanwall"),icon:"icon ion-sb-location-off",click:function(){$scope.closeActions().then(function(){$scope.changeLocationSettings("never",!0)})}})}else{$scope.popoverItems.push({label:$translate.instant("Check my location","fanwall"),icon:"icon ion-sb-location-off",click:function(){$scope.closeActions().then(function(){$scope.requestLocation()})}})}};if($scope.post!==undefined){$scope.pageTitle="Edit post";$scope.form.text=$scope.post.text.replace(/(<br( ?)(\/?)>)/gm,"\n");if($scope.post.image.length>0){$scope.form.picture=$scope.post.image}}
$scope.noLocation=function(){$timeout(function(){$scope.fetchingLocation=!1;$scope.form.location.latitude=0;$scope.form.location.longitude=0;$scope.shortLocation=$translate.instant("no location, check your preferences","fanwall");$scope.form.location.locationShort=$translate.instant("no location, check your preferences","fanwall")})};$scope.fetchLocation=function(){if(!$scope.locationIsDisabled()){$scope.fetchingLocation=!0;Location.getLocation({timeout:10000,enableHighAccuracy:!1},!0).then(function(position){$scope.form.location.latitude=position.coords.latitude;$scope.form.location.longitude=position.coords.longitude;GoogleMaps.reverseGeocode(position.coords).then(function(results){if(results.length>0){var place=results[0];try{$scope.shortLocation=_.find(place.address_components,function(item){return item.types.indexOf("locality")>=0}).long_name}catch(e){$scope.shortLocation=place.formatted_address}
$scope.form.location.locationShort=$scope.shortLocation;$scope.fetchingLocation=!1}},function(){$scope.fetchingLocation=!1;$scope.shortLocation=Number.parseFloat(position.coords.latitude).toFixed(5)+", "+Number.parseFloat(position.coords.longitude).toFixed(5);$scope.form.location.locationShort="unknown"})},function(){$scope.noLocation()})}else{$scope.fetchingLocation=!1}};$scope.init=function(){$scope.buildPopoverItems();switch($scope.preference){case "never":$scope.noLocation();$scope.popoverIcon="icon ion-sb-location-off";break;case "once":$scope.fetchLocation();$scope.changeLocationSettings("never",!1);$scope.popoverIcon="icon ion-android-locate";break;case "ask":$scope.popoverIcon="icon ion-help";Dialog.confirm("Location","Share my location for this post?",["YES","NO"],-1,"fanwall").then(function(success){if(success){$scope.fetchLocation()}else{$scope.noLocation()}});break;case "always":$scope.popoverIcon="icon ion-sb-location-on";$scope.fetchLocation();break}};$session.getItem($scope.preferenceKey).then(function(preference){if(preference===null){$scope.preference="always"}else{$scope.preference=preference}
$scope.init()}).catch(function(err){$scope.preference="always";$scope.init()})});angular.module("starter").controller("FanwallGalleryController",function($rootScope,$scope,$state,$stateParams,$timeout,$ionicScrollDelegate,Fanwall,FanwallGallery){angular.extend($scope,{isLoading:!1,collection:[],hasMore:!1,});FanwallGallery.setValueId($stateParams.value_id);$scope.getCardDesign=function(){return Fanwall.cardDesign};$scope.getSettings=function(){return Fanwall.settings};$scope.imagePath=function(image){if(image.length<=0){return"./features/fanwall2/assets/templates/images/placeholder.png"}
return IMAGE_URL+"images/application"+image};$scope.loadMore=function(){$scope.loadContent(!1,!0)};$scope.loadContent=function(refresh,loadMore){if(refresh===!0){$scope.isLoading=!0;$scope.collection=[];FanwallGallery.collection=[];$timeout(function(){$ionicScrollDelegate.$getByHandle("mainScroll").scrollTop()})}
FanwallGallery.findAll($scope.collection.length,refresh).then(function(payload){$scope.collection=$scope.collection.concat(payload.collection);FanwallGallery.collection=FanwallGallery.collection.concat(payload.collection);$rootScope.$broadcast("fanwall.pageTitle",{pageTitle:payload.pageTitle});$scope.hasMore=$scope.collection.length<payload.total},function(payload){}).then(function(){if(loadMore===!0){$scope.$broadcast("scroll.infiniteScrollComplete")}
if(refresh===!0){$scope.isLoading=!1}})};$rootScope.$on("fanwall.refresh",function(){if($scope.currentTab==="gallery"){$scope.loadContent(!0)}});$scope.loadContent($scope.collection.length===0)});angular.module("starter").controller("FanwallHomeController",function($rootScope,$scope,$state,$stateParams,$translate,$ionicSideMenuDelegate,Customer,Dialog,Location,Fanwall,FanwallUtils,GoogleMaps){angular.extend($scope,{settingsIsLoaded:!1,value_id:$stateParams.value_id,collection:[],pageTitle:"",hasMore:!1,currentTab:"post"});Fanwall.setValueId($stateParams.value_id);$scope.getCardDesign=function(){return Fanwall.cardDesign};$scope.getSettings=function(){return Fanwall.settings};$scope.locationIsDisabled=function(){return!Location.isEnabled};$scope.locationTab=function(){return["nearby","map"].indexOf($scope.currentTab)!==-1};$scope.requestLocation=function(){Dialog.confirm("Error","We were unable to request your location.<br />Please check that the application is allowed to use the GPS and that your device GPS is on.",["TRY AGAIN","DISMISS"],-1,"location").then(function(success){if(success){Location.isEnabled=!0;Loader.show();Location.getLocation({timeout:30000,enableHighAccuracy:!1},!0).then(function(payload){Loader.hide();Dialog.alert("Success","We finally got you location","OK",2350,"fanwall")},function(){Loader.hide();Dialog.alert("Error","We were unable to request your location.<br />Please check that the application is allowed to use the GPS and that your device GPS is on.","OK",3700,"location")})}})};$scope.toggleDesign=function(){Fanwall.toggleDesign()};$scope.showTab=function(tabName){$ionicSideMenuDelegate.canDragContent(tabName!=="map");var homeScope=$scope;if(tabName==="profile"&&!Customer.isLoggedIn()){return Customer.loginModal(undefined,function(){homeScope.showTab("profile")},undefined,function(){homeScope.showTab("profile")})}
$scope.currentTab=tabName};$scope.$on('$ionicView.afterLeave',function(){$ionicSideMenuDelegate.canDragContent(!0)});$scope.classTab=function(key){if($scope.currentTab===key){return["fw-icon-selected","icon-active-custom"]}
return["icon-custom"]};$scope.isEnabled=function(key){var features=$scope.getSettings().features;return features[key]};$scope.displayProfile=function(){var features=$scope.getSettings().features;return features.enableUserLike||features.enableUserPost||features.enableUserComment};$scope.displaySubHeader=function(){var features=$scope.getSettings().features;return features.enableNearby||features.enableMap||features.enableGallery||features.enableUserPost};$scope.displayIcon=function(key){var icons=$scope.getSettings().icons;switch(key){case "post":return(icons.post!==null)?"<img class=\"fw-icon-header icon-topics\" src=\""+icons.post+"\" />":"<i class=\"icon ion-sb-fw-topics\"></i>";case "nearby":return(icons.nearby!==null)?"<img class=\"fw-icon-header icon-nearby\" src=\""+icons.nearby+"\" />":"<i class=\"icon ion-sb-fw-nearby\"></i>";case "map":return(icons.map!==null)?"<img class=\"fw-icon-header icon-map\" src=\""+icons.map+"\" />":"<i class=\"icon ion-sb-fw-map\"></i>";case "gallery":return(icons.gallery!==null)?"<img class=\"fw-icon-header icon-gallery\" src=\""+icons.gallery+"\" />":"<i class=\"icon ion-sb-fw-gallery\"></i>";case "new":return(icons.new!==null)?"<img class=\"fw-icon-header icon-post\" src=\""+icons.new+"\" />":"<i class=\"icon ion-sb-fw-post\"></i>";case "profile":return(icons.profile!==null)?"<img class=\"fw-icon-header icon-post\" src=\""+icons.profile+"\" />":"<i class=\"icon ion-sb-fw-profile\"></i>"}};$scope.refresh=function(){$rootScope.$broadcast("fanwall.refresh")};$scope.newPost=function(){if(!Customer.isLoggedIn()){return Customer.loginModal()}
return FanwallUtils.postModal()};GoogleMaps.init();Fanwall.loadSettings().then(function(payload){Fanwall.settings=angular.copy(payload.settings);Fanwall.cardDesign=Fanwall.settings.cardDesign;$scope.settingsIsLoaded=!0});$rootScope.$on("fanwall.pageTitle",function(event,payload){$scope.pageTitle=payload.pageTitle})});angular.module("starter").controller("FanwallPostController",function($ionicScrollDelegate,$rootScope,$scope,$state,$stateParams,$timeout,FanwallPost){angular.extend($scope,{isLoading:!1,collection:[],hasMore:!1});FanwallPost.setValueId($stateParams.value_id);$scope.loadMore=function(){$scope.loadContent(!1,!0)};$scope.loadContent=function(refresh,loadMore){if(refresh===!0){$scope.isLoading=!0;$scope.collection=[];$timeout(function(){$ionicScrollDelegate.$getByHandle("mainScroll").scrollTop()})}
FanwallPost.findAll($scope.collection.length,refresh).then(function(payload){$scope.collection=$scope.collection.concat(payload.collection);$rootScope.$broadcast("fanwall.pageTitle",{pageTitle:payload.pageTitle});$scope.hasMore=$scope.collection.length<payload.total},function(payload){}).then(function(){if(loadMore===!0){$scope.$broadcast("scroll.infiniteScrollComplete")}
if(refresh===!0){$scope.isLoading=!1}})};$rootScope.$on("fanwall.refresh",function(){if($scope.currentTab==="post"){$scope.loadContent(!0)}});$scope.loadContent($scope.collection.length===0)});angular.module("starter").controller("FanwallProfileController",function($scope,$stateParams,$timeout,Customer,FanwallUtils,FanwallPost,Lightbox){angular.extend($scope,{isLoading:!0,collection:[],customer:Customer.customer,hasMore:!1});FanwallPost.setValueId($stateParams.value_id);$scope.customerFullname=function(){return $scope.customer.firstname+" "+$scope.customer.lastname};$scope.profileCallback=function(){$scope.loadContent(!0,!1);$timeout(function(){$scope.customer=Customer.customer})};$scope.customerImagePath=function(){if($scope.customer.image&&$scope.customer.image.length>0){return IMAGE_URL+"images/customer"+$scope.customer.image}
return"./features/fanwall2/assets/templates/images/customer-placeholder.png"};$scope.editProfile=function(){return Customer.loginModal(undefined,$scope.profileCallback,$scope.profileCallback,$scope.profileCallback)};$scope.showBlockedUsers=function(){FanwallUtils.showBlockedUsersModal()};$scope.loadMore=function(){$scope.loadContent(!1,!0)};$scope.loadContent=function(refresh,loadMore){if(refresh){$scope.isLoading=!0;$scope.collection=[]}
FanwallPost.findAllProfile($scope.collection.length).then(function(payload){$scope.collection=$scope.collection.concat(payload.collection);$scope.hasMore=$scope.collection.length<payload.total;$timeout(function(){Lightbox.run(".list-posts")},200)},function(payload){}).then(function(){if(loadMore===!0){$scope.$broadcast("scroll.infiniteScrollComplete")}
$scope.isLoading=!1})};$scope.loadContent(!0,!1)});angular.module("starter").controller("FanwallProfileBlockedUsersController",function($scope,$rootScope,$stateParams,FanwallPost){angular.extend($scope,{isLoading:!0,});FanwallPost.setValueId($stateParams.value_id);$scope.loadContent=function(){$scope.isLoading=!0;FanwallPost.findAllBlocked().then(function(payload){$scope.collection=payload.collection},function(payload){}).then(function(){$scope.isLoading=!1})};$scope.loadContent();$rootScope.$on("fanwall.blockedUsers.refresh",function(){$scope.loadContent()})});angular.module("starter").controller("FanwallNearbyController",function($ionicScrollDelegate,$rootScope,$scope,$state,$stateParams,$timeout,Fanwall,FanwallPost,Location){angular.extend($scope,{isLoading:!0,collection:[],location:{latitude:0,longitude:0},hasMore:!1});FanwallPost.setValueId($stateParams.value_id);$scope.getCardDesign=function(){return Fanwall.cardDesign};$scope.loadMore=function(){$scope.loadContent(!1,!0)};$scope.locationIsDisabled=function(){return!Location.isEnabled};$scope.loadContent=function(refresh,loadMore){if($scope.locationIsDisabled()){return!1}
if(refresh===!0){$scope.isLoading=!0;$scope.collection=[];$timeout(function(){$ionicScrollDelegate.$getByHandle("mainScroll").scrollTop()})}
return FanwallPost.findAllNearby($scope.location,$scope.collection.length,refresh).then(function(payload){$scope.collection=$scope.collection.concat(payload.collection);$rootScope.$broadcast("fanwall.pageTitle",{pageTitle:payload.pageTitle});$scope.hasMore=$scope.collection.length<payload.total},function(payload){}).then(function(){if(loadMore===!0){$scope.$broadcast("scroll.infiniteScrollComplete")}
if(refresh===!0){$scope.isLoading=!1}})};$rootScope.$on("fanwall.refresh",function(){if($scope.currentTab==="nearby"){$scope.loadContent(!0)}});Location.getLocation({timeout:10000},!0).then(function(position){$scope.location.latitude=position.coords.latitude;$scope.location.longitude=position.coords.longitude},function(){$scope.location.latitude=0;$scope.location.longitude=0}).then(function(){$scope.loadContent($scope.collection.length===0)})});angular.module("starter").controller("FanwallMapController",function($scope,$rootScope,$state,$stateParams,$timeout,$translate,$ionicSideMenuDelegate,Loader,Location,FanwallPost,FanwallUtils){angular.extend($scope,{isLoading:!0,collection:[],showInfoWindow:!1,currentPost:null,filters:{latitude:0,longitude:0,}});FanwallPost.setValueId($stateParams.value_id);$scope.hideInfoWindow=function(){$scope.showInfoWindow=!1};$scope.showPostModal=function(postGroup){FanwallUtils.showPostModal(postGroup)};$scope.$on("$ionicView.enter",function(){$ionicSideMenuDelegate.canDragContent(!1)});$scope.$on("$ionicView.leave",function(){$ionicSideMenuDelegate.canDragContent(!0)});$scope.loadContent=function(){Location.getLocation({timeout:10000},!0).then(function(position){$scope.filters.latitude=position.coords.latitude;$scope.filters.longitude=position.coords.longitude},function(){$scope.filters.latitude=0;$scope.filters.longitude=0}).then(function(){FanwallPost.findAllMap($scope.filters,0,!1).then(function(payload){$scope.collection=payload.collection;$rootScope.$broadcast("fanwall.pageTitle",{pageTitle:payload.pageTitle});var markers=[];for(var position in $scope.collection){var postGroup=$scope.collection[position];var marker={config:{postGroup:angular.copy(postGroup)},onClick:(function(marker){$timeout(function(){$scope.showPostModal(marker.config.postGroup)})})};marker.latitude=position.split("_")[0];marker.longitude=position.split("_")[1];var pinUrl;switch(postGroup.length){case 1:pinUrl="./features/fanwall2/assets/templates/images/pin1.svg";break;case 2:pinUrl="./features/fanwall2/assets/templates/images/pin2.svg";break;case 3:pinUrl="./features/fanwall2/assets/templates/images/pin3.svg";break;case 4:pinUrl="./features/fanwall2/assets/templates/images/pin4.svg";break;case 5:default:pinUrl="./features/fanwall2/assets/templates/images/pin5.svg";break}
marker.icon={url:pinUrl,anchor:new google.maps.Point(26,52),scaledSize:new google.maps.Size(40,40)};markers.push(marker)}
$scope.mapConfig={cluster:!0,markers:markers,bounds_to_marker:!0}}).finally(function(){$scope.isLoading=!1})})};$scope.loadContent()});angular.module("starter").directive("fanwallCommentList",function($timeout,ModalScrollDelegate,Lightbox){return{restrict:"E",replace:!0,templateUrl:"features/fanwall2/assets/templates/l1/modal/directives/comment-list.html",link:function(scope){scope.$watch("post",function(){scope._post=scope.post})},controller:function($rootScope,$scope){$scope.scrollToBottom=function(){$timeout(function(){ModalScrollDelegate.$getByHandle("fanwall-comment-list").scrollBottom(!0);$timeout(function(){Lightbox.run(".list-comments")},200)},200)};$scope.listDidRender=function(){$scope.scrollToBottom()};$rootScope.$on("fanwall.refresh.comments",function(event,payload){if(payload.postId===$scope.post.id){$timeout(function(){$scope.post.comments=angular.copy(payload.comments);$scope.post.commentCount=$scope.post.comments.length})}})}}});angular.module("starter").directive("fanwallCommentItem",function($rootScope,$filter,$timeout,$translate,$q,Customer,Dialog,Loader,Fanwall,FanwallPost,FanwallUtils,Popover){return{restrict:'E',templateUrl:"features/fanwall2/assets/templates/l1/modal/directives/comment-item.html",controller:function($scope){$scope.actionsPopover=null;$scope.popoverItems=[];$scope.getCardDesign=function(){return Fanwall.cardDesign};$scope.getSettings=function(){return Fanwall.settings};$scope.authorImagePath=function(){if($scope.comment.author.image.length<=0){return"./features/fanwall2/assets/templates/images/customer-placeholder.png"}
return IMAGE_URL+"images/customer"+$scope.comment.author.image};$scope.isBlocked=function(){return $scope.comment.isBlocked};$scope.isFromMe=function(){return $scope.comment&&($scope.comment.customerId===Customer.customer.id)};$scope.imagePath=function(){return IMAGE_URL+"images/application"+$scope.comment.image};$scope.showText=function(){return $filter("linky")($scope.comment.text)};$scope.authorName=function(){return $scope.comment.author.firstname+" "+$scope.comment.author.lastname};$scope.publicationDate=function(){return $filter("moment_calendar")($scope.comment.date*1000)};$scope.isOwner=function(){if(!Customer.isLoggedIn()){return!1}
return Customer.customer.id===$scope.comment.customerId};$scope.deleteComment=function(){if(!Customer.isLoggedIn()){return Customer.loginModal()}
var title=$translate.instant("Delete this comment!","fanwall");var message=$translate.instant("Are you sure?","fanwall");return Dialog.confirm(title,message,['YES','NO']).then(function(success){if(success){Loader.show();FanwallPost.deleteComment($scope.comment.id).then(function(payload){$scope.post.comments=angular.copy(payload.comments);$scope.post.commentCount=$scope.post.comments.length},function(payload){Dialog.alert("Error!",payload.message,"OK",-1,"fanwall")}).then(function(){Loader.hide()})}})};$scope.flagComment=function(){if(!Customer.isLoggedIn()){return Customer.loginModal()}
var title=$translate.instant("Report this message!","fanwall");var message=$translate.instant("Please let us know why you think this message is inappropriate.","fanwall");var placeholder=$translate.instant("Your message.","fanwall");return Dialog.prompt(title,message,"text",placeholder,["OK","CANCEL"],-1,"fanwall").then(function(value){Loader.show();FanwallPost.reportComment($scope.comment.id,value).then(function(payload){Dialog.alert("Thanks!",payload.message,"OK",2350,"fanwall")},function(payload){Dialog.alert("Error!",payload.message,"OK",-1,"fanwall")}).then(function(){Loader.hide()})})};$scope.openActions=function($event){$scope.closeActions().then(function(){Popover.fromTemplateUrl("features/fanwall2/assets/templates/l1/modal/directives/actions-popover.html",{scope:$scope}).then(function(popover){$scope.actionsPopover=popover;$scope.actionsPopover.show($event)})})};$scope.closeActions=function(){try{if($scope.actionsPopover){return $scope.actionsPopover.hide()}}catch(e){}
return $q.resolve()};$scope.blockUser=function(){if(!Customer.isLoggedIn()){return Customer.loginModal()}
FanwallUtils.blockUser($scope.comment.id,"from-comment")};$scope.unblockUser=function(){FanwallUtils.unblockUser($scope.comment.id,"from-comment")};$scope.editComment=function(){return FanwallUtils.editCommentModal($scope.comment)};$scope.showHistory=function(){FanwallUtils.showCommentHistoryModal($scope.comment)};$scope.buildPopoverItems=function(){$scope.popoverItems=[];var historyAction={label:$translate.instant("View edit history","fanwall"),icon:"icon ion-clock",click:function(){$scope.closeActions().then(function(){$scope.showHistory()})}};if($scope.isOwner()){$scope.popoverItems.push({label:$translate.instant("Edit comment","fanwall"),icon:"icon ion-edit",click:function(){$scope.closeActions().then(function(){$scope.editComment()})}});if($scope.comment.history.length>0){$scope.popoverItems.push(historyAction)}
$scope.popoverItems.push({label:$translate.instant("Delete comment","fanwall"),icon:"icon ion-android-delete",click:function(){$scope.closeActions().then(function(){$scope.deleteComment()})}})}else{if(!$scope.isBlocked()){$scope.popoverItems.push({label:$translate.instant("Report post","fanwall"),icon:"icon ion-flag",click:function(){$scope.closeActions().then(function(){$scope.flagComment()})}});if($scope.comment.history.length>0){$scope.popoverItems.push(historyAction)}
$scope.popoverItems.push({label:$translate.instant("Block all user posts","fanwall"),icon:"ion-android-remove-circle",click:function(){$scope.closeActions().then(function(){$scope.blockUser()})}})}else{$scope.popoverItems.push({label:$translate.instant("Unblock user","fanwall"),icon:"ion-android-remove-circle",click:function(){$scope.closeActions().then(function(){$scope.unblockUser()})}})}}};$scope.buildPopoverItems();$rootScope.$on("fanwall.refresh.comments",function(event,payload){if(payload.postId===$scope.post.id){$timeout(function(){$scope.buildPopoverItems()})}})}}});angular.module("starter").directive("fanwallCommentHistoryItem",function(Fanwall){return{restrict:"E",templateUrl:"features/fanwall2/assets/templates/l1/modal/comment/history-item.html",controller:function($scope,$filter){$scope.getCardDesign=function(){return Fanwall.cardDesign};$scope.imagePath=function(){if($scope.item.image.length<=0){return"./features/fanwall2/assets/templates/images/placeholder.png"}
return IMAGE_URL+"images/application"+$scope.item.image};$scope.publicationDate=function(){return $filter("moment_calendar")($scope.item.date*1000)}}}});angular.module('starter').directive('fanwallCommentForm',function($timeout,Customer,Dialog,Picture,FanwallPost){return{restrict:'E',replace:!0,templateUrl:"features/fanwall2/assets/templates/l1/modal/directives/comment-form.html",controller:function($scope){angular.extend($scope,{form:{text:"",date:null,picture:null},isSending:!1});$scope.takePicture=function(){if(!Customer.isLoggedIn()){return Customer.loginModal()}
if($scope.isSending){return!1}
return Picture.takePicture().then(function(success){$scope.form.picture=success.image})};$scope.clearComment=function(){$timeout(function(){$scope.form={text:"",picture:null}})};$scope.showClearComment=function(){return($scope.form.text.length>0||$scope.form.picture!==null)};$scope.instantAppend=function(text){var now=Math.round(Date.now()/1000);var comment={id:now,postId:$scope.post.id,customerId:Customer.customer.id,text:text.replace(/(\r\n|\n\r|\r|\n)/g,"<br />"),image:"",isFlagged:!1,date:now,history:[],author:{firstname:Customer.customer.firstname,lastname:Customer.customer.lastname,nickname:Customer.customer.nickname,image:Customer.customer.image}};$scope.post.comments.push(comment)};$scope.sendComment=function(){if(!Customer.isLoggedIn()){return Customer.loginModal()}
if($scope.isSending||!$scope.showClearComment()){return!1}
$scope.form.date=Math.round(Date.now()/1000);$scope.instantAppend($scope.form.text);$scope.isSending=!0;return FanwallPost.sendComment($scope.post.id,null,$scope.form).then(function(payload){$scope.clearComment();$timeout(function(){$scope.post.comments=angular.copy(payload.comments);$scope.post.commentCount=$scope.post.comments.length})},function(payload){Dialog.alert("Error",payload.message,"OK",-1,"fanwall");$scope.post.comments.pop()}).then(function(){$scope.isSending=!1})}}}});angular.module("starter").directive("fanwallPostList",function($timeout,Lightbox){return{restrict:"E",replace:!0,templateUrl:"features/fanwall2/assets/templates/l1/tabs/directives/post-list.html",link:function(scope){scope.$watch("post",function(){console.log("Updating local post instance");scope._post=scope.post})},controller:function($scope){$scope.listDidRender=function(){$timeout(function(){Lightbox.run(".list-posts")},200)}}}});angular.module("starter").directive("fanwallPostItem",function($rootScope,$filter,$sce,$translate,$timeout,$q,Customer,Dialog,Loader,Fanwall,FanwallPost,FanwallUtils,Lightbox,Popover){return{restrict:'E',templateUrl:"features/fanwall2/assets/templates/l1/tabs/directives/post-item.html",controller:function($scope){$scope.actionsPopover=null;$scope.popoverItems=[];$scope.getCardDesign=function(){return Fanwall.cardDesign};$scope.getSettings=function(){return Fanwall.settings};$scope.userLike=function(){return $scope.getSettings().features.enableUserLike};$scope.userComment=function(){return $scope.getSettings().features.enableUserComment};$scope.showText=function(){return $filter("linky")($scope.post.text)};$scope.showLikeOrComment=function(){return($scope.post.likeCount>0||$scope.post.commentCount>0)&&($scope.canLikeOrComment())};$scope.canLikeOrComment=function(){return($scope.userLike()||$scope.userComment())};$scope.imagePath=function(){if($scope.post.image.length<=0){return"./features/fanwall2/assets/templates/images/placeholder.png"}
return IMAGE_URL+"images/application"+$scope.post.image};$scope.authorImagePath=function(){if($scope.post.author.image.length<=0){return"./features/fanwall2/assets/templates/images/customer-placeholder.png"}
if($scope.post.author.image.indexOf("/var/cache")===0){return IMAGE_URL+$scope.post.author.image}
return IMAGE_URL+"images/customer"+$scope.post.author.image};$scope.liked=function(){return $scope.post.likes};$scope.authorName=function(){return $scope.post.author.firstname+" "+$scope.post.author.lastname};$scope.publicationDate=function(){return $filter("moment_calendar")($scope.post.date*1000)};$scope.openActions=function($event){$scope.closeActions().then(function(){Popover.fromTemplateUrl("features/fanwall2/assets/templates/l1/tabs/directives/actions-popover.html",{scope:$scope}).then(function(popover){$scope.actionsPopover=popover;$scope.actionsPopover.show($event)})})};$scope.closeActions=function(){try{if($scope.actionsPopover){return $scope.actionsPopover.hide()}}catch(e){}
return $q.resolve()};$scope.flagPost=function(){var title=$translate.instant("Report this message!","fanwall");var message=$translate.instant("Please let us know why you think this message is inappropriate.","fanwall");var placeholder=$translate.instant("Your message.","fanwall");Dialog.prompt(title,message,"text",placeholder,["OK","CANCEL"],-1,"fanwall").then(function(value){Loader.show();FanwallPost.reportPost($scope.post.id,value).then(function(payload){Dialog.alert("Thanks!",payload.message,"OK",2350,"fanwall")},function(payload){Dialog.alert("Error!",payload.message,"OK",-1,"fanwall")}).then(function(){Loader.hide()})})};$scope.buildPopoverItems=function(){var viewHistory={label:$translate.instant("View edit history","fanwall"),icon:"icon ion-clock",click:function(){$scope.closeActions().then(function(){$scope.showHistory()})}};if($scope.isOwner()){$scope.popoverItems.push({label:$translate.instant("Edit post","fanwall"),icon:"icon ion-edit",click:function(){$scope.closeActions().then(function(){$scope.editPost()})}});if($scope.post.history.length>0){$scope.popoverItems.push(viewHistory)}
$scope.popoverItems.push({label:$translate.instant("Delete post","fanwall"),icon:"icon ion-android-delete",click:function(){$scope.closeActions().then(function(){$scope.deletePost()})}})}else{$scope.popoverItems.push({label:$translate.instant("Report post","fanwall"),icon:"icon ion-flag",click:function(){$scope.closeActions().then(function(){$scope.flagPost()})}});if($scope.post.history.length>0){$scope.popoverItems.push(viewHistory)}
if($scope.post.customerId!==0){$scope.popoverItems.push({label:$translate.instant("Block all user posts","fanwall"),icon:"ion-android-remove-circle",click:function(){$scope.closeActions().then(function(){$scope.blockUser()})}})}}};$scope.blockUser=function(){if(!Customer.isLoggedIn()){return Customer.loginModal()}
FanwallUtils.blockUser($scope.post.id,"from-post")};$scope.showHistory=function(){FanwallUtils.showPostHistoryModal($scope.post)};$scope.deletePost=function(){Dialog.confirm("Confirmation","You are about to delete this post!",["YES","NO"],-1,"fanwall").then(function(value){if(!value){return}
Loader.show();FanwallPost.deletePost($scope.post.id,value).then(function(payload){$rootScope.$broadcast("fanwall.refresh")},function(payload){Dialog.alert("Error!",payload.message,"OK",-1,"fanwall")}).then(function(){Loader.hide()})})};$scope.commentModal=function(){FanwallUtils.commentModal($scope.post)};$scope.toggleLike=function(){if(!Customer.isLoggedIn()){return Customer.loginModal()}
if($scope.post.likeLocked===!0){return!1}
$scope.post.likeLocked=!0;if($scope.post.iLiked){$scope.post.iLiked=!1;FanwallPost.unlike($scope.post.id).then(function(payload){$scope.post.likeCount--},function(payload){$scope.post.iLiked=!0}).then(function(){$scope.post.likeLocked=!1})}else{$scope.post.iLiked=!0;FanwallPost.like($scope.post.id).then(function(payload){$scope.post.likeCount++},function(payload){$scope.post.iLiked=!1}).then(function(){$scope.post.likeLocked=!1})}
return!0};$scope.isOwner=function(){if(!Customer.isLoggedIn()){return!1}
return Customer.customer.id===$scope.post.customerId};$scope.editPost=function(){return FanwallUtils.postModal($scope.post)};$scope.buildPopoverItems();$rootScope.$on("fanwall.modal.ready",function(){$timeout(function(){Lightbox.run(".show-post")},200)})}}});angular.module("starter").directive("fanwallPostHistoryItem",function(Fanwall){return{restrict:"E",templateUrl:"features/fanwall2/assets/templates/l1/modal/post/history-item.html",controller:function($scope,$filter){$scope.getCardDesign=function(){return Fanwall.cardDesign};$scope.imagePath=function(){if($scope.item.image.length<=0){return"./features/fanwall2/assets/templates/images/placeholder.png"}
return IMAGE_URL+"images/application"+$scope.item.image};$scope.publicationDate=function(){return $filter("moment_calendar")($scope.item.date*1000)}}}});angular.module("starter").directive("fanwallGallery",function($timeout,ModalScrollDelegate,Lightbox){return{restrict:"E",replace:!0,templateUrl:"features/fanwall2/assets/templates/l1/tabs/directives/gallery.html",controller:function($scope){$scope.listDidRender=function(){$timeout(function(){Lightbox.run(".fanwall-gallery")},200)};$scope.imagePath=function(item){return IMAGE_URL+"images/application"+item.image}}}});angular.module("starter").directive("fanwallBlockedUserItem",function($stateParams,$rootScope,$translate,$q,FanwallPost,FanwallUtils,Popover){return{restrict:'E',templateUrl:"features/fanwall2/assets/templates/l1/modal/profile/blocked-user-item.html",controller:function($scope){$scope.actionsPopover=null;$scope.popoverItems=[];FanwallPost.setValueId($stateParams.value_id);$scope.customerFullname=function(){return $scope.item.firstname+" "+$scope.item.lastname};$scope.customerImagePath=function(){if($scope.item.image.length<=0){return"./features/fanwall2/assets/templates/images/customer-placeholder.png"}
return IMAGE_URL+"images/customer"+$scope.item.image};$scope.unblockUser=function(){FanwallUtils.unblockUser($scope.item.id,"from-user").then(function(){$rootScope.$broadcast("fanwall.blockedUsers.refresh")})};$scope.openActions=function($event){$scope.closeActions().then(function(){Popover.fromTemplateUrl("features/fanwall2/assets/templates/l1/tabs/directives/actions-popover.html",{scope:$scope}).then(function(popover){$scope.actionsPopover=popover;$scope.actionsPopover.show($event)})})};$scope.closeActions=function(){try{if($scope.actionsPopover){return $scope.actionsPopover.hide()}}catch(e){}
return $q.resolve()};$scope.buildPopoverItems=function(){$scope.popoverItems=[];$scope.popoverItems.push({label:$translate.instant("Unblock user","fanwall"),icon:"icon ion-android-remove-circle",click:function(){$scope.closeActions().then(function(){$scope.unblockUser()})}})};$scope.buildPopoverItems()}}});angular.module("starter").factory("Fanwall",function($pwaRequest){var factory={value_id:null,settings:[],cardDesign:!1};factory.setValueId=function(value_id){factory.value_id=value_id};factory.loadSettings=function(){var payload=$pwaRequest.getPayloadForValueId(factory.value_id);if(payload!==!1){return $pwaRequest.resolve(payload)}
return $pwaRequest.get("fanwall/mobile_home/load-settings",{urlParams:{value_id:factory.value_id}})};factory.toggleDesign=function(){factory.cardDesign=!factory.cardDesign};return factory});angular.module("starter").factory("FanwallUtils",function($rootScope,$timeout,Dialog,Loader,Modal,FanwallPost){var factory={_postModal:null,_showPostModal:null,_showPostHistoryModal:null,_showBlockedUsersModal:null,_commentModal:null,_editCommentModal:null};factory.postModal=function(post){Modal.fromTemplateUrl("features/fanwall2/assets/templates/l1/modal/new.html",{scope:angular.extend($rootScope.$new(!0),{post:post,close:function(){factory._postModal.hide()}}),animation:"slide-in-right-left"}).then(function(modal){factory._postModal=modal;factory._postModal.show();return modal})};factory.showPostModal=function(postGroup){var _localScope=angular.extend($rootScope.$new(!0),{modalReady:!1,close:function(){factory._showPostModal.hide()}});Modal.fromTemplateUrl("features/fanwall2/assets/templates/l1/modal/post.html",{scope:_localScope,animation:"slide-in-right-left"}).then(function(modal){factory._showPostModal=modal;factory._showPostModal.show();$timeout(function(){_localScope.postGroup=postGroup;_localScope.isPostDetails=!0;_localScope.modalReady=!0;$rootScope.$broadcast("fanwall.modal.ready")},500);return modal})};factory.showPostHistoryModal=function(post){var _localScope=angular.extend($rootScope.$new(!0),{modalReady:!1,close:function(){factory._showPostHistoryModal.hide()}});Modal.fromTemplateUrl("features/fanwall2/assets/templates/l1/modal/post/history.html",{scope:_localScope,animation:"slide-in-right-left"}).then(function(modal){factory._showPostHistoryModal=modal;factory._showPostHistoryModal.show();$timeout(function(){_localScope.post=post;_localScope.modalReady=!0;$rootScope.$broadcast("fanwall.modal.ready")},500);return modal})};factory.showCommentHistoryModal=function(comment){var _localScope=angular.extend($rootScope.$new(!0),{modalReady:!1,close:function(){factory._showPostHistoryModal.hide()}});Modal.fromTemplateUrl("features/fanwall2/assets/templates/l1/modal/comment/history.html",{scope:_localScope,animation:"slide-in-right-left"}).then(function(modal){factory._showPostHistoryModal=modal;factory._showPostHistoryModal.show();$timeout(function(){_localScope.comment=comment;_localScope.modalReady=!0;$rootScope.$broadcast("fanwall.modal.ready")},500);return modal})};factory.showBlockedUsersModal=function(){var _localScope=angular.extend($rootScope.$new(!0),{close:function(){factory._showBlockedUsersModal.hide()}});Modal.fromTemplateUrl("features/fanwall2/assets/templates/l1/modal/profile/blocked.html",{scope:_localScope,animation:"slide-in-right-left"}).then(function(modal){factory._showBlockedUsersModal=modal;factory._showBlockedUsersModal.show();return modal})};factory.commentModal=function(post){Modal.fromTemplateUrl("features/fanwall2/assets/templates/l1/modal/comment.html",{scope:angular.extend($rootScope.$new(!0),{post:post,close:function(){factory._commentModal.hide()}}),animation:"slide-in-right-left"}).then(function(modal){factory._commentModal=modal;factory._commentModal.show();return modal})};factory.editCommentModal=function(comment){Modal.fromTemplateUrl("features/fanwall2/assets/templates/l1/modal/comment/edit.html",{scope:angular.extend($rootScope.$new(!0),{comment:comment,close:function(){factory._editCommentModal.hide()}}),animation:"slide-in-right-left"}).then(function(modal){factory._editCommentModal=modal;factory._editCommentModal.show();return modal})};factory.blockUser=function(sourceId,from){Dialog.confirm("Confirmation","You are about to block all this user messages!",["YES","NO"],-1,"fanwall").then(function(value){if(!value){return}
Loader.show();FanwallPost.blockUser(sourceId,from).then(function(payload){if(payload.refresh){$rootScope.$broadcast("fanwall.refresh");$rootScope.$broadcast("fanwall.refresh.comments",{comments:payload.comments,postId:payload.postId})}
Dialog.alert("Thanks!",payload.message,"OK",2350,"fanwall")},function(payload){Dialog.alert("Error!",payload.message,"OK",-1,"fanwall")}).then(function(){Loader.hide()})})};factory.unblockUser=function(sourceId,from){Dialog.confirm("Confirmation","You are about to unblock all this user messages!",["YES","NO"],-1,"fanwall").then(function(value){if(!value){return}
Loader.show();FanwallPost.unblockUser(sourceId,from).then(function(payload){if(payload.refresh){$rootScope.$broadcast("fanwall.refresh");$rootScope.$broadcast("fanwall.refresh.comments",{comments:payload.comments,postId:payload.postId})}
Dialog.alert("Thanks!",payload.message,"OK",2350,"fanwall")},function(payload){Dialog.alert("Error!",payload.message,"OK",-1,"fanwall")}).then(function(){Loader.hide()})})};return factory});angular.module("starter").factory("FanwallPost",function($pwaRequest){var factory={value_id:null,extendedOptions:{},collections:[]};factory.setValueId=function(value_id){factory.value_id=value_id};factory.setExtendedOptions=function(options){factory.extendedOptions=options};factory.preFetch=function(){};factory.findAll=function(offset,refresh){if(!this.value_id){return $pwaRequest.reject("[Factory::FanwallPost.findAll] missing value_id")}
return $pwaRequest.get("fanwall/mobile_post/find-all",angular.extend({urlParams:{value_id:this.value_id,offset:offset},refresh:refresh},factory.extendedOptions))};factory.findAllNearby=function(location,offset,refresh){if(!this.value_id){return $pwaRequest.reject("[Factory::FanwallPost.findAllNearby] missing value_id")}
return $pwaRequest.get("fanwall/mobile_post/find-all-nearby",angular.extend({urlParams:{value_id:this.value_id,latitude:location.latitude,longitude:location.longitude,offset:offset},refresh:refresh},factory.extendedOptions))};factory.findAllProfile=function(offset){if(!this.value_id){return $pwaRequest.reject("[Factory::FanwallPost.findAllProfile] missing value_id")}
return $pwaRequest.get("fanwall/mobile_post/find-all-profile",angular.extend({urlParams:{value_id:this.value_id,offset:offset},refresh:!0},factory.extendedOptions))};factory.findAllBlocked=function(){if(!this.value_id){return $pwaRequest.reject("[Factory::FanwallPost.findAllBlocked] missing value_id")}
return $pwaRequest.get("fanwall/mobile_post/find-all-blocked",angular.extend({urlParams:{value_id:this.value_id},refresh:!0},factory.extendedOptions))};factory.findAllMap=function(location,offset,refresh){if(!this.value_id){return $pwaRequest.reject("[Factory::FanwallPost.findAllMap] missing value_id")}
return $pwaRequest.get("fanwall/mobile_post/find-all-map",angular.extend({urlParams:{value_id:this.value_id,latitude:location.latitude,longitude:location.longitude,offset:offset},refresh:refresh},factory.extendedOptions))};factory.like=function(postId){if(!this.value_id){return $pwaRequest.reject("[Factory::FanwallPost.like] missing value_id")}
return $pwaRequest.post("fanwall/mobile_post/like-post",angular.extend({urlParams:{value_id:this.value_id,postId:postId}},factory.extendedOptions))};factory.unlike=function(postId){if(!this.value_id){return $pwaRequest.reject("[Factory::FanwallPost.like] missing value_id")}
return $pwaRequest.post("fanwall/mobile_post/unlike-post",angular.extend({urlParams:{value_id:this.value_id,postId:postId}},factory.extendedOptions))};factory.sendPost=function(postId,form){return $pwaRequest.post("fanwall/mobile_post/send-post",{urlParams:{value_id:factory.value_id},data:{postId:postId,form:form},cache:!1})};factory.sendComment=function(postId,commentId,form){return $pwaRequest.post("fanwall/mobile_post/send-comment",{urlParams:{value_id:factory.value_id},data:{postId:postId,commentId:commentId,form:form},cache:!1})};factory.reportPost=function(postId,reportMessage){return $pwaRequest.post("fanwall/mobile_report/report-post",{urlParams:{value_id:factory.value_id},data:{postId:postId,reportMessage:reportMessage}})};factory.blockUser=function(sourceId,from){return $pwaRequest.post("fanwall/mobile_post/block-user",{urlParams:{value_id:factory.value_id},data:{from:from,sourceId:sourceId}})};factory.unblockUser=function(sourceId,from){return $pwaRequest.post("fanwall/mobile_post/unblock-user",{urlParams:{value_id:factory.value_id},data:{from:from,sourceId:sourceId}})};factory.deletePost=function(postId){return $pwaRequest.post("fanwall/mobile_post/delete-post",{urlParams:{value_id:factory.value_id},data:{postId:postId}})};factory.deleteComment=function(commentId){return $pwaRequest.post("fanwall/mobile_post/delete-comment",{urlParams:{value_id:factory.value_id,commentId:commentId}})};factory.reportComment=function(commentId,reportMessage){return $pwaRequest.post("fanwall/mobile_report/report-comment",{urlParams:{value_id:factory.value_id},data:{commentId:commentId,reportMessage:reportMessage}})};return factory});angular.module("starter").factory("FanwallGallery",function($pwaRequest){var factory={value_id:null,extendedOptions:{},collection:[]};factory.setValueId=function(value_id){factory.value_id=value_id};factory.setExtendedOptions=function(options){factory.extendedOptions=options};factory.findAll=function(offset,refresh){if(!this.value_id){return $pwaRequest.reject("[Factory::FanwallGallery.findAll] missing value_id")}
return $pwaRequest.get("fanwall/mobile_gallery/find-all",angular.extend({urlParams:{value_id:this.value_id,offset:offset},refresh:refresh},factory.extendedOptions))};return factory});Features.insertCSS(":root{--safe-area-inset-top:0;--safe-area-inset-right:0;--safe-area-inset-bottom:0;--safe-area-inset-left:0}@supports (padding-top:constant(safe-area-inset-top)){:root{--safe-area-inset-top:constant(safe-area-inset-top);--safe-area-inset-right:constant(safe-area-inset-right);--safe-area-inset-bottom:constant(safe-area-inset-bottom);--safe-area-inset-left:constant(safe-area-inset-left)}}@supports (padding-top:env(safe-area-inset-top)){:root{--safe-area-inset-top:env(safe-area-inset-top);--safe-area-inset-right:env(safe-area-inset-right);--safe-area-inset-bottom:env(safe-area-inset-bottom);--safe-area-inset-left:env(safe-area-inset-left)}}.platform-overview.platform-cordova{--safe-area-inset-top:1.5em;--safe-area-inset-right:0;--safe-area-inset-bottom:.5em;--safe-area-inset-left:0}.module-fanwall.popover{margin-top:10px!important;transform:translate(-14px,-14px);border-radius:2px!important}.module-fanwall.popover.popover-custom{max-height:260px;border-radius:2px!important}.module-fanwall.popover.popover-custom .item-custom{padding:10px!important}.module-fanwall.popover.popover-custom .popover-icon-left{width:20px;text-align:center;display:inline-block;transform:translate(0,-5px)}.module-fanwall.popover.popover-custom .popover-action-title{font-size:10px;font-weight:700;transform:translate(6px,-1px);display:inline-block;letter-spacing:1px;text-overflow:ellipsis;width:calc(100% - 40px);overflow:hidden}.module-fanwall.popover.popover-custom .popover-content-custom{border-radius:2px!important;margin:0!important;background:none}.module-fanwall.popover.popover-custom .popover-arrow{display:none!important}.module-fanwall .fanwall-profile .customer-image{margin-top:15px;margin-bottom:15px}.module-fanwall .fanwall-profile .customer-image img{margin:0 auto;width:10em;border-radius:5em;border:.4em solid #fff;display:block}.module-fanwall .fanwall-profile .customer-fullname{font-size:1.2em;text-align:center;margin-bottom:15px}.module-fanwall .fanwall-profile .customer-actions{text-align:center}.module-fanwall .fanwall-profile .section-title h2{font-size:16px!important;font-weight:bold!important;padding-bottom:7px}.module-fanwall .user-blocked.item-avatar{min-height:52px!important}.module-fanwall .item-history{padding:10px!important}.module-fanwall .item-history .history-date{font-size:11px;line-height:11px}.module-fanwall .item-history .history-text{margin-top:10px;white-space:initial}.module-fanwall .item-history img{max-width:100%;margin:0 auto;display:block}.module-fanwall .blocked-item{opacity:.5}.module-fanwall .no-post{white-space:normal!important;padding-top:15px!important;padding-bottom:15px!important}.module-fanwall .fanwall-map .map-canvas{width:100%;height:100%}.module-fanwall .fanwall-map .info-window .item{padding-top:10px;padding-bottom:10px;margin:-1px 0!important;border-top:0;border-bottom:0}.module-fanwall .fanwall-map .info-window .info-window-icon{padding:10px;border-bottom:0}.module-fanwall .fanwall-map .info-window .info-window-icon span{font-size:.85rem;font-weight:700;width:85%;display:inline-block}.module-fanwall .fanwall-map .info-window .info-window-icon span.info-window-title{padding-left:8px;padding-bottom:6px}.module-fanwall .fanwall-map .info-window .info-window-icon span.info-window-more,.module-fanwall .fanwall-map .info-window .info-window-icon span.info-window-distance{font-size:.7rem;width:auto}.module-fanwall .fanwall-map .info-window .info-window-icon span.info-window-distance{padding-left:8px}.module-fanwall .fanwall-map .info-window .info-window-icon i.info-close{position:absolute;right:10px;top:8px}.module-fanwall.fanwall-list-l1 .bar-subheader{padding:0!important}.module-fanwall.fanwall-list-l1 .bar-subheader .button-bar>.button.button-positive-custom.activated{background-color:#387ef5!important;border-color:#0c60ee!important}.module-fanwall.fanwall-list-l1 .bar-subheader .button-bar>.button img{filter:grayscale(100%)}.module-fanwall.fanwall-list-l1 .bar-subheader .button-bar>.button img.fw-icon-header{height:24px;margin-top:8px}.module-fanwall.fanwall-list-l1 .bar-subheader .button-bar>.button i{filter:grayscale(100%)}.module-fanwall.fanwall-list-l1 .bar-subheader .button-bar>.button i.icon:before{font-size:24px!important}.module-fanwall.fanwall-list-l1 .bar-subheader .button-bar>.button:first-child{border-radius:0}.module-fanwall.fanwall-list-l1 .bar-subheader .button-bar>.button:last-child{border-radius:0}.module-fanwall.fanwall-list-l1 .bar-subheader .button-bar>.button:active img,.module-fanwall.fanwall-list-l1 .bar-subheader .button-bar>.button.fw-icon-selected img,.module-fanwall.fanwall-list-l1 .bar-subheader .button-bar>.button:active i,.module-fanwall.fanwall-list-l1 .bar-subheader .button-bar>.button.fw-icon-selected i{filter:grayscale(0)}.module-fanwall.fanwall-list-l1 .item{padding-bottom:0;margin-top:12px;margin-bottom:0}.module-fanwall.fanwall-list-l1 .item .post-body{padding-top:10px;padding-bottom:10px}.module-fanwall.fanwall-list-l1 .item .post-body h2{padding:0 0 10px 0;font-weight:700}.module-fanwall.fanwall-list-l1 .item .post-body p{overflow:initial;text-overflow:initial;white-space:initial}.module-fanwall.fanwall-list-l1 .item .post-body p.subtitle{padding:8px 0}.module-fanwall.fanwall-list-l1 .item .post-author.item-avatar{padding-left:50px;min-height:50px}.module-fanwall.fanwall-list-l1 .item .post-author h2{font-weight:700;line-height:16px;height:16px;margin-top:3px}.module-fanwall.fanwall-list-l1 .item .post-author h2 i.icon{margin:0 0 0 12px;font-size:20px}.module-fanwall.fanwall-list-l1 .item .post-author h2 i.icon.icon-pin{transform:rotate(20deg)}.module-fanwall.fanwall-list-l1 .item .post-author .post-date{font-size:11px}.module-fanwall.fanwall-list-l1 .item .post-image{margin:0 -16px 0 -16px}.module-fanwall.fanwall-list-l1 .item .post-image img{display:block}.module-fanwall.fanwall-list-l1 .item .post-likes{padding-top:4px;padding-bottom:4px}.module-fanwall.fanwall-list-l1 .item .post-likes span{font-size:14px}.module-fanwall.fanwall-list-l1 .item .post-actions{padding-top:7px;padding-bottom:6px;font-weight:700}.module-fanwall.fanwall-list-l1 .item .post-likes~.post-actions{border-top:1px solid rgba(68,68,68,.2)}.module-fanwall.fanwall-list-l1 .item .post-body~.post-actions{border-top:1px solid rgba(68,68,68,.2)}.module-fanwall.fanwall-list-l1 .item.card .post-likes~.post-actions{border-top:1px solid rgba(68,68,68,.2)}.module-fanwall.fanwall-list-l1 .item.card .post-body~.post-actions{border-top:1px solid rgba(68,68,68,.2)}.module-fanwall.fanwall-list-l1 .item.card .post-author{padding-top:16px}.module-fanwall.fanwall-comment-l1 .item-comment .comment-date~.comment-image{margin-top:10px}.module-fanwall.fanwall-comment-l1 .item-comment .comment-author.item-avatar{padding-top:5px;padding-left:50px;min-height:50px}.module-fanwall.fanwall-comment-l1 .item-comment .comment-author i.icon{font-size:16px}.module-fanwall.fanwall-comment-l1 .item-comment .comment-author h2{font-weight:700;font-size:13px;line-height:15px}.module-fanwall.fanwall-comment-l1 .item-comment .comment-author p.comment-date{font-size:11px;line-height:11px}.module-fanwall.fanwall-comment-l1 .item-comment .comment-author p.comment-text{margin-top:10px;white-space:initial}.module-fanwall.fanwall-comment-l1 .item-comment .comment-author p.comment-text *{white-space:initial}.module-fanwall.fanwall-comment-l1 .item-comment .comment-image img{max-width:100%;max-height:140px;padding:3px;border:1px solid #c4c4c4;border-radius:6px}.module-fanwall.fanwall-comment-l1 .item-comment.card{margin-bottom:0;margin-top:12px}.module-fanwall.fanwall-comment-l1 .item-comment.card .comment-image img{border:1px solid #c4c4c4}.module-fanwall.fanwall-comment-l1 .item-comment.card .comment-author.item-avatar{padding-top:15px;padding-left:50px;padding-bottom:10px;min-height:50px}.module-fanwall.fanwall-comment-l1 .comment-footer .item-input-inset{width:100%}.module-fanwall.fanwall-comment-l1 .comment-footer .picture-badge{font-size:10px;padding:0 6px 0 5px;margin-left:-17px}.module-fanwall.fanwall-comment-l1 .comment-footer textarea{resize:none;margin:0;height:32px;width:100%;padding:8px 33px 7px 16px;border-radius:50px}.module-fanwall.fanwall-comment-l1 .comment-footer .clear-comment{font-size:26px;position:absolute;right:54px;opacity:.6}.module-fanwall.fanwall-new-l1 .post-button{position:fixed;bottom:0;z-index:100;margin:0!important}.module-fanwall.fanwall-new-l1 .post-author.item-avatar{padding-left:72px;min-height:50px}.module-fanwall.fanwall-new-l1 .post-author h2{font-weight:700;line-height:15px}.module-fanwall.fanwall-new-l1 .post-author h2 i.icon{margin:0 0 0 12px}.module-fanwall.fanwall-new-l1 .post-author h2 i.icon.icon-pin{transform:rotate(30deg)}.module-fanwall.fanwall-new-l1 .post-author .post-location{font-size:11px}.module-fanwall.fanwall-new-l1 .new-post-items .item{margin-top:12px;padding-top:15px;padding-bottom:15px;padding-right:15px}.module-fanwall.fanwall-new-l1 .new-post-items .item .new-post-author{margin-top:4px}.module-fanwall.fanwall-new-l1 .new-post-items .item label{width:100%}.module-fanwall.fanwall-new-l1 .new-post-items .item textarea{resize:none}.module-fanwall.fanwall-new-l1 .new-post-items .item.item-avatar{padding-left:72px;min-height:72px}.module-fanwall.fanwall-new-l1 .new-post-items .item.card{margin-top:0;margin-bottom:6px}.module-fanwall.fanwall-new-l1 .new-post-items .item.card:first-of-type{margin-top:12px!important}.module-fanwall.fanwall-new-l1 .remove-image-list,.module-fanwall.fanwall-new-l1 .remove-image-card{position:absolute;right:6px;top:6px}.module-fanwall.fanwall-new-l1 .remove-image-list i.icon,.module-fanwall.fanwall-new-l1 .remove-image-card i.icon{font-size:26px}.module-fanwall .fanwall-gallery{justify-content:flex-start;display:flex;flex-direction:row;flex-flow:row wrap}.module-fanwall .fanwall-gallery .gallery-item{background-position:center center;background-repeat:no-repeat;background-size:cover}.module-fanwall .fanwall-gallery .gallery-item img{width:100%}.module-fanwall .fanwall-gallery .gallery-item:nth-child(3n+1){width:32%;margin-top:2%}.module-fanwall .fanwall-gallery .gallery-item:nth-child(3n+2){width:32%;margin-left:2%;margin-right:2%;margin-top:2%}.module-fanwall .fanwall-gallery .gallery-item:nth-child(3n+3){width:32%;margin-top:2%}@media screen and (orientation:portrait){.module-fanwall .fanwall-map .info-window{width:100vw;position:absolute;bottom:0;padding:0 2vw}}@media screen and (orientation:landscape){.module-fanwall .fanwall-map .info-window{width:50vw;position:absolute;bottom:0;left:0;padding:0 2vw}}#baguetteBox-overlay{user-select:all;pointer-events:all}.fanwall-location-action:before{font-size:26px!important}","fanwall2")