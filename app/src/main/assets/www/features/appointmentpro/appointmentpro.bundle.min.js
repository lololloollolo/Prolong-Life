angular.module('starter').controller('AppointmentproHomeController',function(Dialog,Loader,Application,$ionicSideMenuDelegate,Customer,$session,Modal,$ionicScrollDelegate,$timeout,$ionicHistory,$translate,$rootScope,$ionicModal,Appointmentpro,Location,$scope,$state,$stateParams,$controller){angular.extend(this,$controller('AppointmentproCommanController',{Dialog:Dialog,$rootScope:$rootScope,$scope:$scope,$stateParams:$stateParams,Appointmentpro:Appointmentpro}));$scope.value_id=Appointmentpro.value_id=$stateParams.value_id;$scope.widget=Appointmentpro.widget=$stateParams.widget;$scope.settings=Appointmentpro.getAppointmentproSettings();Appointmentpro.cart={};$scope.payout={};$scope.postParams={};$scope.activeTab='about';if(Appointmentpro.widget!==null&&Appointmentpro.widget=='213848'){$ionicSideMenuDelegate.canDragContent(!1)}
$scope.findLocationInfo=function(){$scope.is_loading=!0;Appointmentpro.findLocationInfo($scope.payout.single_location_id).success(function(data){$scope.location_info=data.location;$scope.is_loading=!1}).error(function(error){$scope.is_loading=!1;Dialog.alert($translate.instant("Error","appointmentpro"),error.message,"OK",-1,"appointmentpro")}).finally(function(){$scope.$broadcast('scroll.infiniteScrollComplete')})};$scope.loadContent=function(){$scope.is_loading=!0;Appointmentpro.findAll($scope.postParams).success(function(data){$scope.page_title=data.page_title;$scope.payout=data;$scope.settings=data.settings;Appointmentpro.setAppointmentproSettings(data.settings);Appointmentpro.setLabels(data.labels);if(data.is_single_location){$scope.findLocationInfo()}else{$scope.is_loading=!1}}).error(function(error){$scope.is_loading=!1;Dialog.alert($translate.instant("Error","appointmentpro"),error.message,"OK",-1,"appointmentpro")}).finally(function(){$scope.$broadcast('scroll.infiniteScrollComplete')})};$scope.getLocation=function(){if(Location.isEnabled&&$scope.settings.default_location_sorting==='distance'){Location.getLocation({timeout:10000},!0).then(function(position){$scope.postParams.latitude=position.coords.latitude;$scope.postParams.longitude=position.coords.longitude;$scope.loadContent()},function(){$scope.postParams.latitude='';$scope.postParams.longitude='';$scope.requestLocation()})}else{$scope.postParams.latitude='';$scope.postParams.longitude='';if($scope.settings.default_location_sorting==='distance'){$scope.requestLocation()}
$scope.loadContent()}}
$scope.requestLocation=function(){Location.requestLocation(function(){$scope.loadContent()},function(){$scope.loadContent()})}
$scope.$on("$ionicView.beforeEnter",function(event,data){$scope.getLocation()});$scope.login=function(){if(!Customer.isLoggedIn()){Customer.loginModal($scope,function(){$timeout(function(){$scope.is_logged_in=Customer.isLoggedIn();$scope.customer=Customer.customer;$state.go('home').then(function(){$state.go("appointmentpro-home",{value_id:$scope.value_id},{reload:!0})})},1000)})}else{Customer.loginModal()}}
$scope.clickTabs=function(value){$scope.activeTab=value}
$scope.locationServiceModal=function(category_id){$scope.location_service=[];Loader.show();$ionicModal.fromTemplateUrl('features/appointmentpro/assets/templates/modal/location/service.html',{scope:$scope,animation:'slide-in-right-left'}).then(function(modal){Appointmentpro.findLocationServiceByCategory($scope.payout.single_location_id,category_id).success(function(data){$scope.location_service=data.services},function(error){Dialog.alert($translate.instant("Error","appointmentpro"),error.message,$translate.instant("Ok","appointmentpro"),-1,'appointmentpro')}).then(function(){Loader.hide()});$scope.modalLocationService=modal;$scope.modalLocationService.show()})};$scope.closeModalLocationService=function(){$scope.modalLocationService.remove()}
$scope.bookNow=function(){if(!Customer.isLoggedIn()){$scope.login();return!1}
$state.go("appointmentpro-category",{value_id:$scope.value_id,location_id:$scope.location_info.location_id},{reload:!0})};$scope.bookAService=function(service){if(!Customer.isLoggedIn()){$scope.login();return!1}
if(!$scope.settings.enable_booking){return!1}
$scope.closeModalLocationService();$scope.cart=Appointmentpro.cart;$scope.cart.location_id=$scope.location_info.location_id;$scope.cart.category_id=service.category_id;$scope.cart.service_id=service.service_id;Appointmentpro.cart=$scope.cart;$state.go("appointmentpro-provider",{value_id:$scope.value_id,service_id:service.service_id},{reload:!0})}});angular.module('starter').controller('AppointmentproCommanController',function($rootScope,SB,$scope,$stateParams,$state,$translate,Loader,$timeout,Appointmentpro,$ionicModal,Customer){$scope.settings=Appointmentpro.getAppointmentproSettings();$scope.value_id=Appointmentpro.value_id=$stateParams.value_id;$scope.forTranslate=function(text){return $translate.instant(text,"appointmentpro")};$scope.getLabelName=function(key){$scope.labels=Appointmentpro.getLabels();return $translate.instant($scope.labels[key],"appointmentpro")};$scope.appointmentproSliderImage=function(image){if(image!=''&&image!=null&&image!="null"){return IMAGE_URL+'images/application'+image}else{return"./features/appointmentpro/assets/media/default-image.png"}};$scope.appointmentproImage=function(image){if(image!=''&&image!=null&&image!="null"&&image!='0'){return IMAGE_URL+'images/application'+image}else{return"./features/appointmentpro/assets/media/customer-placeholder.png"}};$scope.classDetails=function(service_id){$scope.is_loading_modal=!0;Loader.show();$ionicModal.fromTemplateUrl('features/appointmentpro/assets/templates/modal/classes/details.html',{scope:$scope,animation:'slide-in-right-left'}).then(function(modal){Appointmentpro.getClassInfo(service_id).success(function(data){$scope.class_info=data.class;Loader.hide();$scope.is_loading_modal=!1}).error(function(error){Loader.hide();$scope.is_loading_modal=!1;Dialog.alert($translate.instant("Error","appointmentpro"),error.message,"OK",-1,"appointmentpro")});$scope.modalclassDetails=modal;$scope.modalclassDetails.show()})};$scope.closeModalClassDetails=function(){$scope.modalclassDetails.remove()}
$scope.loginRequired=function(){if(!Customer.isLoggedIn()){Customer.loginModal($scope,function(){Loader.show();$timeout(function(){$scope.is_logged_in=Customer.isLoggedIn();$scope.customer=Customer.customer;$state.go('home').then(function(){$state.go("appointmentpro-home",{value_id:$scope.value_id},{reload:!0})})},1000)})}else{Customer.loginModal()}}
$scope.bookClassNow=function(service){if(!Customer.isLoggedIn()){$scope.loginRequired();return!1}
$scope.cart=Appointmentpro.cart;$scope.cart.provider_id=service.provider_id;$scope.cart.service_id=service.service_id;$scope.cart.category_id=service.category_id;$scope.cart.location_id=service.location_id;$scope.cart.is_class=!0;$scope.cart.class=service;$scope.cart.tickets_qty=1
$scope.cart.total_amount=($scope.cart.tickets_qty*service.price);Appointmentpro.cart=$scope.cart;$scope.closeModalClassDetails();$state.go("book-a-class",{value_id:$scope.value_id},{reload:!0})}
$scope.range=function(min,max){var input=[];for(var i=min;i<=max;i++)input.push(i);return input};$scope.goToProviderService=function(provider){if(!Customer.isLoggedIn()){$scope.loginRequired();return!1}
$scope.cart=Appointmentpro.cart;$scope.cart.provider_id=provider.provider_id;$scope.cart.location_id=provider.location_id;$scope.cart.tickets_qty=1
Appointmentpro.cart=$scope.cart;console.log($scope.value_id);$state.go("provider-services",{value_id:$scope.value_id,provider_id:provider.provider_id},{reload:!0})}
$scope.goToProviderCalendar=function(service_id){$scope.cart=Appointmentpro.cart;$scope.cart.service_id=service_id;Appointmentpro.cart=$scope.cart;$state.go("appointmentpro-calendar",{value_id:$scope.value_id,provider_id:$scope.cart.provider_id},{reload:!0})}
$scope.goToCategoriesLocation=function(category){if(!Customer.isLoggedIn()){$scope.loginRequired();return!1}
$scope.cart=Appointmentpro.cart;$scope.cart.category_id=category.category_id;$scope.cart.tickets_qty=1
Appointmentpro.cart=$scope.cart;console.log('category_for',category.category_for);if(category.category_for==2){$state.go("appointmentpro-classes",{value_id:$scope.value_id,category_id:category.category_id},{reload:!0})}else{$state.go("appointmentpro-category-location",{value_id:$scope.value_id,category_id:category.category_id},{reload:!0})}}
$scope.goToLocationServices=function(location){if(!Customer.isLoggedIn()){$scope.loginRequired();return!1}
$scope.cart=Appointmentpro.cart;$scope.cart.location_id=location.location_id;Appointmentpro.cart=$scope.cart;$state.go("appointmentpro-service",{value_id:$scope.value_id,category_id:$scope.cart.category_id},{reload:!0})}});angular.module('starter').controller('AppointmentproLocationController',function(Dialog,Loader,Customer,$session,Modal,$timeout,$translate,$rootScope,Appointmentpro,Location,$scope,$state,$stateParams,$controller){angular.extend(this,$controller('AppointmentproCommanController',{Dialog:Dialog,$rootScope:$rootScope,$scope:$scope,$stateParams:$stateParams,Appointmentpro:Appointmentpro}));$scope.value_id=Appointmentpro.value_id=$stateParams.value_id;$scope.settings=Appointmentpro.getAppointmentproSettings();$scope.payout={};$scope.postParams={};$scope.loadContent=function(){$scope.is_loading=!0;Appointmentpro.findAllLocations($scope.postParams).success(function(data){$scope.payout=data;$scope.is_loading=!1}).error(function(error){$scope.is_loading=!1;Dialog.alert($translate.instant("Error","appointmentpro"),error.message,"OK",-1,"appointmentpro")}).finally(function(){$scope.$broadcast('scroll.infiniteScrollComplete')})};$scope.loadContent();$scope.getLocation=function(){if(Location.isEnabled){Location.getLocation({timeout:10000},!0).then(function(position){$scope.postParams.latitude=position.coords.latitude;$scope.postParams.longitude=position.coords.longitude;$scope.loadContent()},function(){$scope.postParams.latitude='';$scope.postParams.longitude='';$scope.requestLocation()})}else{$scope.postParams.latitude='';$scope.postParams.longitude='';$scope.requestLocation();$scope.loadContent()}}
$scope.requestLocation=function(){Location.requestLocation(function(){$scope.loadContent()},function(){$scope.loadContent()})}
$scope.$on("$ionicView.beforeEnter",function(event,data){$scope.getLocation()})}).controller('AppointmentproLocationByCategoryController',function(Dialog,Loader,Customer,$session,Modal,$timeout,$translate,$rootScope,Appointmentpro,Location,$scope,$state,$stateParams,$controller){angular.extend(this,$controller('AppointmentproCommanController',{Dialog:Dialog,$rootScope:$rootScope,$scope:$scope,$stateParams:$stateParams,Appointmentpro:Appointmentpro}));$scope.value_id=Appointmentpro.value_id=$stateParams.value_id;$scope.category_id=$stateParams.category_id;$scope.settings=Appointmentpro.getAppointmentproSettings();$scope.payout={};$scope.postParams={};$scope.loadContent=function(){$scope.is_loading=!0;Appointmentpro.findLocationByCategoryId($scope.category_id,$scope.postParams).success(function(data){$scope.payout=data;Loader.hide();$scope.is_loading=!1}).error(function(error){$scope.is_loading=!1;Dialog.alert($translate.instant("Error","appointmentpro"),error.message,"OK",-1,"appointmentpro")}).finally(function(){$scope.$broadcast('scroll.infiniteScrollComplete')})};$scope.loadContent();$scope.getLocation=function(){if(Location.isEnabled){Location.getLocation({timeout:10000},!0).then(function(position){$scope.postParams.latitude=position.coords.latitude;$scope.postParams.longitude=position.coords.longitude;$scope.loadContent()},function(){$scope.postParams.latitude='';$scope.postParams.longitude='';$scope.requestLocation()})}else{$scope.postParams.latitude='';$scope.postParams.longitude='';$scope.requestLocation();$scope.loadContent()}}
$scope.requestLocation=function(){Location.requestLocation(function(){$scope.loadContent()},function(){$scope.loadContent()})}
$scope.$on("$ionicView.beforeEnter",function(event,data){$scope.getLocation()})});angular.module('starter').controller('AppointmentproLocationDetailsController',function(Dialog,Loader,Application,$ionicSideMenuDelegate,Customer,$session,Modal,$ionicScrollDelegate,$timeout,$ionicHistory,$translate,$rootScope,Appointmentpro,$scope,$state,$stateParams,$controller,$ionicModal){angular.extend(this,$controller('AppointmentproCommanController',{Dialog:Dialog,$rootScope:$rootScope,$scope:$scope,$stateParams:$stateParams,Appointmentpro:Appointmentpro}));$scope.value_id=Appointmentpro.value_id=$stateParams.value_id;$scope.settings=Appointmentpro.getAppointmentproSettings();$scope.location_id=$stateParams.location_id;$scope.is_logged_in=Customer.isLoggedIn();$scope.payout={};$scope.activeTab='about';Appointmentpro.cart={};$scope.loadContent=function(){$scope.is_loading=!0;Appointmentpro.findLocationInfo($scope.location_id).success(function(data){$scope.location_info=data.location;$scope.is_loading=!1}).error(function(error){$scope.is_loading=!1;Dialog.alert($translate.instant("Error","appointmentpro"),error.message,"OK",-1,"appointmentpro")}).finally(function(){$scope.$broadcast('scroll.infiniteScrollComplete')})};$scope.loadContent();$scope.clickTabs=function(value){$scope.activeTab=value}
$scope.locationServiceModal=function(category_id){$scope.is_loading_modal=!0;$scope.location_service=[];$ionicModal.fromTemplateUrl('features/appointmentpro/assets/templates/modal/location/service.html',{scope:$scope,animation:'slide-in-right-left'}).then(function(modal){Appointmentpro.findLocationServiceByCategory($scope.location_id,category_id).success(function(data){$scope.location_service=data.services},function(error){Dialog.alert($translate.instant("Error","appointmentpro"),error.message,$translate.instant("Ok","appointmentpro"),-1,'appointmentpro')}).then(function(){$scope.is_loading_modal=!1});$scope.modalLocationService=modal;$scope.modalLocationService.show()})};$scope.closeModalLocationService=function(){$scope.modalLocationService.remove()}
$scope.login=function(){if(!Customer.isLoggedIn()){Customer.loginModal($scope,function(){$timeout(function(){$scope.is_logged_in=Customer.isLoggedIn();$scope.customer=Customer.customer;$state.go('home').then(function(){$state.go("appointmentpro-home",{value_id:$scope.value_id},{reload:!0})})},1000)})}else{Customer.loginModal()}}
$scope.bookNow=function(){if(!Customer.isLoggedIn()){$scope.login();return!1}
$state.go("appointmentpro-category",{value_id:$scope.value_id,location_id:$scope.location_info.location_id},{reload:!0})};$scope.bookAService=function(service){if(!Customer.isLoggedIn()){$scope.login();return!1}
if(!$scope.settings.enable_booking){return!1}
$scope.closeModalLocationService();$scope.cart=Appointmentpro.cart;$scope.cart.location_id=$scope.location_info.location_id;$scope.cart.category_id=service.category_id;$scope.cart.service_id=service.service_id;Appointmentpro.cart=$scope.cart;$state.go("appointmentpro-provider",{value_id:$scope.value_id,service_id:service.service_id},{reload:!0})}});angular.module('starter').controller('AppointmentproCategoryController',function(Dialog,Loader,Application,$ionicSideMenuDelegate,Customer,$session,Modal,$ionicScrollDelegate,$timeout,$ionicHistory,$translate,$rootScope,Appointmentpro,$scope,$state,$stateParams,$controller){angular.extend(this,$controller('AppointmentproCommanController',{Dialog:Dialog,$rootScope:$rootScope,$scope:$scope,$stateParams:$stateParams,Appointmentpro:Appointmentpro}));$scope.value_id=Appointmentpro.value_id=$stateParams.value_id;$scope.settings=Appointmentpro.getAppointmentproSettings();$scope.location_id=$stateParams.location_id;$scope.payout={};$scope.cart=Appointmentpro.cart;$scope.cart.location_id=$scope.location_id;$scope.loadContent=function(){$scope.is_loading=!0;Appointmentpro.findCategoryByLocation($scope.location_id).success(function(data){$scope.payout=data;if(data.categories.length==1&&(Appointmentpro.isUndefined($scope.cart.category_id)||$scope.cart.category_id===0)){$state.go("appointmentpro-service",{value_id:$scope.value_id,category_id:data.categories[0].main_category_id},{reload:!0})}
if((!Appointmentpro.isUndefined($scope.cart.category_id)||$scope.cart.category_id>0)&&data.categories.length==1){$ionicHistory.goBack()}
$scope.is_loading=!1}).error(function(error){$scope.is_loading=!1;Dialog.alert($translate.instant("Error","appointmentpro"),error.message,"OK",-1,"appointmentpro")}).finally(function(){$scope.$broadcast('scroll.infiniteScrollComplete')})};$scope.loadContent()});angular.module('starter').controller('AppointmentproServiceController',function(Dialog,Loader,Application,$ionicSideMenuDelegate,Customer,$session,Modal,$ionicScrollDelegate,$timeout,$ionicHistory,$translate,$rootScope,Appointmentpro,$scope,$state,$stateParams,$controller){angular.extend(this,$controller('AppointmentproCommanController',{Dialog:Dialog,$rootScope:$rootScope,$scope:$scope,$stateParams:$stateParams,Appointmentpro:Appointmentpro}));$scope.value_id=Appointmentpro.value_id=$stateParams.value_id;$scope.settings=Appointmentpro.getAppointmentproSettings();$scope.category_id=$stateParams.category_id;$scope.payout={};$scope.cart=Appointmentpro.cart;$scope.cart.category_id=$scope.category_id;$scope.loadContent=function(){$scope.is_loading=!0;Appointmentpro.findServiceByLocationCategory($scope.cart).success(function(data){$scope.payout=data;$scope.is_loading=!1}).error(function(error){$scope.is_loading=!1;Dialog.alert($translate.instant("Error","appointmentpro"),error.message,"OK",-1,"appointmentpro")}).finally(function(){$scope.$broadcast('scroll.infiniteScrollComplete')})};$scope.loadContent()}).controller('AppointmentproProviderServiceController',function(Dialog,Loader,Application,$ionicSideMenuDelegate,Customer,$session,Modal,$ionicScrollDelegate,$timeout,$ionicHistory,$translate,$rootScope,Appointmentpro,$scope,$state,$stateParams,$controller){angular.extend(this,$controller('AppointmentproCommanController',{Dialog:Dialog,$rootScope:$rootScope,$scope:$scope,$stateParams:$stateParams,Appointmentpro:Appointmentpro}));$scope.value_id=Appointmentpro.value_id=$stateParams.value_id;$scope.provider_id=Appointmentpro.provider_id=$stateParams.provider_id;$scope.settings=Appointmentpro.getAppointmentproSettings();$scope.payout={};$scope.cart=Appointmentpro.cart;$scope.loadContent=function(){$scope.is_loading=!0;Appointmentpro.findProviderServices($scope.cart).success(function(data){$scope.payout=data;$scope.is_loading=!1}).error(function(error){$scope.is_loading=!1;Dialog.alert($translate.instant("Error","appointmentpro"),error.message,"OK",-1,"appointmentpro")}).finally(function(){$scope.$broadcast('scroll.infiniteScrollComplete')})};$scope.loadContent()});angular.module('starter').controller('AppointmentproProviderController',function(Dialog,Loader,Application,$ionicSideMenuDelegate,Customer,$session,Modal,$ionicScrollDelegate,$timeout,$ionicHistory,$translate,$rootScope,Appointmentpro,$scope,$state,$stateParams,$controller){angular.extend(this,$controller('AppointmentproCommanController',{Dialog:Dialog,$rootScope:$rootScope,$scope:$scope,$stateParams:$stateParams,Appointmentpro:Appointmentpro}));$scope.value_id=Appointmentpro.value_id=$stateParams.value_id;$scope.settings=Appointmentpro.getAppointmentproSettings();$scope.service_id=$stateParams.service_id;$scope.payout={};$scope.cart=Appointmentpro.cart;$scope.cart.service_id=$scope.service_id;console.log("Cart",$scope.cart);$scope.loadContent=function(){$scope.is_loading=!0;Appointmentpro.findServiceProvider($scope.cart).success(function(data){$scope.payout=data;$scope.is_loading=!1}).error(function(error){$scope.is_loading=!1;Dialog.alert($translate.instant("Error","appointmentpro"),error.message,"OK",-1,"appointmentpro")}).finally(function(){$scope.$broadcast('scroll.infiniteScrollComplete')})};$scope.loadContent()});angular.module('starter').controller('AppointmentproCalendarController',function(Dialog,Loader,Application,$ionicSideMenuDelegate,Customer,$session,Modal,$ionicScrollDelegate,$timeout,$ionicModal,$ionicHistory,$translate,$rootScope,Appointmentpro,$scope,$state,$stateParams,$controller,$compile){angular.extend(this,$controller('AppointmentproCommanController',{Dialog:Dialog,$rootScope:$rootScope,$scope:$scope,$stateParams:$stateParams,Appointmentpro:Appointmentpro}));$scope.value_id=Appointmentpro.value_id=$stateParams.value_id;$scope.settings=Appointmentpro.getAppointmentproSettings();$scope.provider_id=$stateParams.provider_id;$scope.payout={};$scope.cart=Appointmentpro.cart;$scope.cart.provider_id=$scope.provider_id;$scope.cart.is_class=!1;var d=new Date();var present_month=d.getMonth();var present_date=d.getDate();function calendari(widget,data){var month=[$translate.instant("January","appointmentpro"),$translate.instant("February","appointmentpro"),$translate.instant("March","appointmentpro"),$translate.instant("April","appointmentpro"),$translate.instant("May","appointmentpro"),$translate.instant("June","appointmentpro"),$translate.instant("July","appointmentpro"),$translate.instant("August","appointmentpro"),$translate.instant("September","appointmentpro"),$translate.instant("October","appointmentpro"),$translate.instant("November","appointmentpro"),$translate.instant("December","appointmentpro")];var days=[$translate.instant("Sunday","appointmentpro"),$translate.instant("Monday","appointmentpro"),$translate.instant("Tuesday","appointmentpro"),$translate.instant("Wednesday","appointmentpro"),$translate.instant("Thursday","appointmentpro"),$translate.instant("Friday","appointmentpro"),$translate.instant("Saturday","appointmentpro")];var days_abr=[$translate.instant("Sun","appointmentpro"),$translate.instant("Mon","appointmentpro"),$translate.instant("Tue","appointmentpro"),$translate.instant("Wed","appointmentpro"),$translate.instant("Thu","appointmentpro"),$translate.instant("Fri","appointmentpro"),$translate.instant("Sat","appointmentpro")];Number.prototype.pad=function(num){var str='';for(var i=0;i<(num-this.toString().length);i++)
str+='0';return str+=this.toString()};var original=widget.getElementsByClassName('active')[0];if(typeof original==='undefined'){original=document.createElement('table');original.setAttribute('data-actual',data.getFullYear()+'/'+data.getMonth()+'/'+data.getDate());widget.appendChild(original)}
var diff=data-new Date(original.getAttribute('data-actual'));diff=new Date(diff).getMonth();var e=document.createElement('table');e.addclass='table table-bordered table-fixed monthview-datetable';e.className=diff===0?'hide-left':'hidden-right';e.innerHTML='';widget.appendChild(e);e.setAttribute('data-actual',data.getDate().pad(2)+'/'+(data.getMonth()).pad(2)+'/'+data.getFullYear());var row=document.createElement('tr');var title=document.createElement('th');title.setAttribute('colspan',7);var boto_prev=document.createElement('button');boto_prev.className='boto-prev';boto_prev.innerHTML='&#9666;';var boto_next=document.createElement('button');boto_next.className='boto-next';boto_next.innerHTML='&#9656;';title.appendChild(boto_prev);title.appendChild(document.createElement('span')).innerHTML=month[data.getMonth()]+'<span class="any">'+data.getFullYear()+'</span>';title.appendChild(boto_next);boto_prev.onclick=function(){data.setMonth(data.getMonth()-1);calendari(widget,data)};boto_next.onclick=function(){data.setMonth(data.getMonth()+1);calendari(widget,data)};row.appendChild(title);e.appendChild(row);row=document.createElement('tr');for(var i=1;i<7;i++){row.innerHTML+='<th><small>'+days_abr[i]+'</small></th>'}
row.innerHTML+='<th><small>'+days_abr[0]+'</small></th>';e.appendChild(row);var cal_mes=new Date(data.getFullYear(),data.getMonth(),-1).getDay();if(cal_mes==6){var actual=new Date(data.getFullYear(),data.getMonth())}else{var actual=new Date(data.getFullYear(),data.getMonth(),-cal_mes)}
for(var s=0;s<6;s++){var row=document.createElement('tr');for(var d=1;d<8;d++){var cell=document.createElement('td');var span=document.createElement('small');cell.appendChild(span);cell.setAttribute('id',actual.getDate().pad(2)+'/'+(actual.getMonth()+1).pad(2)+'/'+actual.getFullYear());cell.setAttribute('class',actual.getDate().pad(2)+'-'+(actual.getMonth()+1).pad(2)+'-'+actual.getFullYear());var full_date=actual.getDate().pad(2)+'/'+(actual.getMonth()+1).pad(2)+'/'+actual.getFullYear();$scope.date=full_date;if(actual.getMonth()!==data.getMonth()){cell.className='text-muted'}else{span.innerHTML=actual.getDate();if((data.getDate()>actual.getDate())&&(actual.getMonth()==present_month)){cell.className='previous'}else{cell.setAttribute('ng-click','selectDate("'+full_date+'")')}}
if(actual.getDate()==present_date&&actual.getMonth()==present_month)
cell.className='today';actual.setDate(actual.getDate()+1);$compile(cell)($scope);row.appendChild(cell)}
e.appendChild(row);if(actual.getMonth()!==data.getMonth()&&(actual.getMonth()>data.getMonth())){break}}
setTimeout(function(){e.className='active';original.className+=diff===0?' hidden-right':' hide-left'},20);original.className='inactive';setTimeout(function(){var inactives=document.getElementsByClassName('inactive');for(var i=0;i<inactives.length;i++)
widget.removeChild(inactives[i]);})}
$scope.loadContent=function(){$timeout(function(){calendari(document.getElementById('calendar'),new Date())})};$scope.loadContent();function removeClassById(id,klass){document.getElementById(id).classList.remove(klass)}
function addClassById(id,klass){document.getElementById(id).classList.add(klass)}
function removeClassByClass(klass,css_klass){[].forEach.call(document.getElementsByClassName(klass),function(el){el.classList.remove(css_klass)})}
function addClassByClass(klass,css_klass){[].forEach.call(document.getElementsByClassName(klass),function(el){el.classList.add(css_klass)})}
$scope.selectDate=function(date){console.log('date',date);$scope.cart.slot_date=date;$scope.is_loading_time=!0;removeClassByClass('is-date-selected',"item-divider-custom");removeClassByClass('is-date-selected',"item-divider");if($scope.date!=''){removeClassByClass($scope.date.split("/").join("-"),"is-date-selected");removeClassByClass($scope.date.split("/").join("-"),"item-divider");removeClassByClass($scope.date.split("/").join("-"),"item-divider-custom");addClassByClass(date.split("/").join("-"),"is-date-selected");addClassByClass(date.split("/").join("-"),"item-divider");addClassByClass(date.split("/").join("-"),"item-divider-custom")}
$scope.display_date=date;if($scope.date_format=='mm/dd/yyyy'){var display_date=date.split("/");$scope.display_date=display_date[1]+'/'+display_date[0]+'/'+display_date[2]}
Appointmentpro.availabletimeSlot($scope.cart,date).success(function(data){$scope.payout=data.data;$scope.morningTime={};$scope.afternoonTime={};$scope.eveningTime={};var d=new Date(),isToday=!1,t=0;var dd=('0'+d.getDate()).slice(-2)+'/'+('0'+(d.getMonth()+1)).slice(-2)+'/'+d.getFullYear();if(date==dd){isToday=!0;t=(d.getHours()*3600)+(d.getMinutes()*60)}
if($scope.payout.status=='success'){for(var key in $scope.payout.data.displayTime){if(isToday&&key<t){continue}
if(key<43200){$scope.morningTime[key]=$scope.payout.data.displayTime[key]}
if(key>=43200&&key<61200){$scope.afternoonTime[key]=$scope.payout.data.displayTime[key]}
if(key>=61200){$scope.eveningTime[key]=$scope.payout.data.displayTime[key]}}}
$scope.is_loading_time=!1}).error(function(error){$scope.is_loading_time=!1;Dialog.alert($translate.instant("Error","appointmentpro"),error.message,"OK",-1,"appointmentpro")}).finally(function(){$scope.$broadcast('scroll.infiniteScrollComplete')});return($scope.showTime?$scope.showTime=!1:$scope.showTime=!0)};$scope.choiceSlotTime=function(k,v){$scope.cart.slot_time=k;$scope.cart.slot_display_time=v;Appointmentpro.cart=$scope.cart;$state.go("appointmentpro-checkout",{value_id:$scope.value_id},{reload:!0})}});angular.module('starter').controller('AppointmentproCheckoutController',function(Dialog,Loader,Application,$ionicSideMenuDelegate,Customer,$session,Modal,$ionicScrollDelegate,$timeout,$ionicModal,$ionicHistory,$translate,$rootScope,Appointmentpro,$scope,$state,$stateParams,$controller,$compile){angular.extend(this,$controller('AppointmentproCommanController',{Dialog:Dialog,$rootScope:$rootScope,$scope:$scope,$stateParams:$stateParams,Appointmentpro:Appointmentpro}));$scope.value_id=Appointmentpro.value_id=$stateParams.value_id;$scope.settings=Appointmentpro.getAppointmentproSettings();$scope.is_logged_in=Customer.isLoggedIn();$scope.payout={};$scope.cart=Appointmentpro.cart;if(Customer.isLoggedIn()){$scope.customer=Customer.customer;$scope.cart.customer=Customer.customer;$scope.cart.phone_number=Customer.mobile}else{$scope.cart.customer={firstname:'',lastname:'',email:'',phone_number:''}}
$scope.confirmModal=function(){$scope.is_loading_modal=!0;$ionicModal.fromTemplateUrl('features/appointmentpro/assets/templates/modal/booking/confirm.html',{scope:$scope,animation:'slide-in-right-left'}).then(function(modal){Appointmentpro.findConfirmBookingData($scope.cart).success(function(data){$scope.booking_info=data.data;$scope.cart.details=data.data;$scope.is_loading_modal=!1},function(error){Dialog.alert($translate.instant("Error","appointmentpro"),error.message,$translate.instant("Ok","appointmentpro"),-1,'appointmentpro')}).then(function(){});$scope.modalConfirmBooking=modal;$scope.modalConfirmBooking.show()})};$scope.closeModalConfirmBooking=function(){$scope.modalConfirmBooking.remove()}
$scope.login=function(){console.log("login ->",Customer.isLoggedIn());if(!Customer.isLoggedIn()){Customer.loginModal($scope,function(){$scope.is_logged_in=Customer.isLoggedIn()})}}
$scope.avatarUrl=function(){if($scope.customer.image&&$scope.customer.image.indexOf('data:')===0){return $scope.customer.image}
return Customer.getAvatarUrl()};$scope.continueOrder=function(){console.log("Cart",$scope.cart);$scope.closeModalConfirmBooking();Appointmentpro.cart=$scope.cart;setTimeout(function(){$state.go("appointmentpro-payment",{value_id:$scope.value_id},{reload:!0})},300)}});angular.module('starter').controller('AppointmentproPaymentController',function(Dialog,Loader,Application,$ionicSideMenuDelegate,Customer,$session,Modal,$ionicScrollDelegate,$timeout,$ionicModal,$ionicHistory,$translate,$rootScope,$ionicLoading,Appointmentpro,$scope,$state,$stateParams,$controller,$compile,$window){$scope.value_id=Appointmentpro.value_id=$stateParams.value_id;$scope.settings=Appointmentpro.getAppointmentproSettings();$scope.payout={};$scope.years=[];$scope.cardElement=null;$scope.cart=Appointmentpro.cart;$scope.cart.payment_method='';$scope.gateway_code='';$scope.loadContent=function(){$scope.is_loading=!0;Appointmentpro.findPaymentMethods($scope.cart.location_id).success(function(data){$scope.payout=data;Appointmentpro.publishable_key=data.publishable_key;$scope.is_loading=!1}).error(function(error){$scope.is_loading=!1;Dialog.alert($translate.instant("Error","appointmentpro"),error.message,"OK",-1,"appointmentpro")}).finally(function(){$scope.$broadcast('scroll.infiniteScrollComplete')})};var stripeJS=document.createElement("script");stripeJS.type="text/javascript";stripeJS.src="https://js.stripe.com/v3/";stripeJS.onload=function(){Appointmentpro.isReadyPromise.resolve(Stripe)};document.body.appendChild(stripeJS);$scope.loadContent();$scope.populateURL=function(param){if(!Application.is_webview){$ionicLoading.show({content:'Please Wait...',animation:'fade-in',showBackdrop:!0,maxWidth:200,showDelay:0});var browser=$window.open(param.paypal_url,$rootScope.getTargetForLink(),'location=yes');browser.addEventListener('loadstart',function(event){var newurl=event.url.split('/?__goto__=');var res=newurl[0].concat(newurl[1]);if(/(confirm)/.test(event.url)){var url=event.url;var first_split=url.split('?');var second_split=first_split[1].split('&');var token_split=second_split[0].split('=');var tokenId=token_split[1];var payer_split=second_split[1].split('=');var payerId=payer_split[1];if(tokenId!=''&&payerId!=''){$scope.cart=param;$scope.cart.status='success';$scope.cart.tokenId=tokenId;$scope.cart.txn=payerId;$scope.updateBookingStatus($scope.cart);browser.close();$ionicLoading.hide()}else{$scope.cart=param;$scope.cart.status='failed';$scope.cart.tokenId='';$scope.cart.txn='';$scope.updateBookingStatus($scope.cart);browser.close();$ionicLoading.hide()}}else if(/(cancel)/.test(event.url)){$scope.cart=param;$scope.cart.status='failed';$scope.cart.tokenId='';$scope.cart.txn='';$scope.updateBookingStatus($scope.cart);browser.close();$ionicLoading.hide()}})}else{$window.location=param.paypal_url}}
$scope.updateBookingStatus=function(param){var booking_id=param.booking_id;Loader.show();Appointmentpro.updatePaymentStatus(param).then(function(data){if(param.status=='success'){Dialog.alert($translate.instant("Success","appointmentpro"),$translate.instant("Payment has been successfully","appointmentpro"),$translate.instant("OK","appointmentpro"),-1,"appointmentpro")}
if(param.status=='failed'){Dialog.alert($translate.instant("Error","appointmentpro"),$translate.instant("Payment has been failed","appointmentpro"),$translate.instant("OK","appointmentpro"),-1,"appointmentpro")}
$state.go("home",{value_id:$scope.value_id},{reload:!0}).then(function(){$state.go("appointmentpro-home",{value_id:$scope.value_id},{reload:!0}).then(function(){Loader.hide();$state.go("appointmentpro-booked-success",{value_id:$scope.value_id,booking_id:param.booking_id},{reload:!0})})})},function(error){Loader.hide();Dialog.alert($translate.instant("Error","appointmentpro"),error.message,$translate.instant("OK","appointmentpro"),-1,"appointmentpro")})}
$scope.placeOrder=function(){if($scope.cart.payment_method==''){Dialog.alert($translate.instant("Error","Appointmentpro"),$translate.instant("Please select a payment method!","Appointmentpro"),$translate.instant("OK","Appointmentpro"),-1);return!0}
Appointmentpro.cart=$scope.cart;Loader.show();Appointmentpro.bookingSubmit($scope.cart).then(function(data){Loader.hide();if(data.is_paypal&&data.booking_status){$scope.cart.booking_id=data.booking_id;$scope.cart.paypal_url=data.paypalURL;Appointmentpro.set_local('PAYPAL_BEFORE_DATA',JSON.stringify($scope.cart));$scope.populateURL($scope.cart)}else{if(!data.booking_status){Dialog.alert($translate.instant("Error","appointmentpro"),data.message,$translate.instant("OK","appointmentpro"))}else{Dialog.alert($translate.instant("Success","appointmentpro"),data.message,$translate.instant("OK","appointmentpro"))}
$state.go("home",{value_id:$scope.value_id},{reload:!0}).then(function(){$state.go("appointmentpro-home",{value_id:$scope.value_id},{reload:!0}).then(function(){Loader.hide();$state.go("appointmentpro-booked-success",{value_id:$scope.value_id,booking_id:data.booking_id},{reload:!0})})})}},function(error){Loader.hide();Dialog.alert($translate.instant("Error","appointmentpro"),error.message,$translate.instant("OK","appointmentpro"),-1)})}
$scope.selectPaymentMethod=function(method){if(method.gateway_code=='stripe'){if(!Appointmentpro.publishable_key||Appointmentpro.publishable_key==null){Dialog.alert($translate.instant("Error","appointmentpro"),$translate.instant("This payment methods are temporarily unavailable","appointmentpro"),$translate.instant("OK","appointmentpro"),-1);return!1}
$scope.gateway_code=method.gateway_code;var current_year=new Date().getFullYear();for(var i=current_year;i<=current_year+20;i++){$scope.years.push({value:i+''})}
$timeout(function(){try{Appointmentpro.StripeInstance=Stripe(Appointmentpro.publishable_key);var elements=Appointmentpro.StripeInstance.elements();var style={base:{color:"#32325d",fontFamily:"'Helvetica Neue', Helvetica, sans-serif",fontSmoothing:"antialiased",fontSize:"16px","::placeholder":{color:"#aab7c4"}},invalid:{color:"#fa755a",iconColor:"#fa755a"}};$scope.cardElement=elements.create("card",{hidePostalCode:!0,style:style});var saveElement=document.getElementById("appointmentpro_save_element");var displayError=document.getElementById("appointmentpro_card_errors");var displayErrorParent=document.getElementById("appointmentpro_card_errors_parent");saveElement.setAttribute("disabled","disabled");$scope.cardElement.removeEventListener("change");$scope.cardElement.addEventListener("change",function(event){if(event.error){displayErrorParent.classList.remove("ng-hide");displayError.textContent=event.error.message;saveElement.setAttribute("disabled","disabled")}else{displayErrorParent.classList.add("ng-hide");displayError.textContent="";saveElement.removeAttribute("disabled")}});$scope.cardElement.mount("#appointmentpro_card_element")}catch(error){Dialog.alert($translate.instant("Error","appointmentpro"),error.message,$translate.instant("Ok","appointmentpro"))}},300)}else{$scope.gateway_code=method.gateway_code}
$rootScope.$broadcast("refreshPageSize");$scope.$broadcast('scroll.infiniteScrollComplete')}
$scope.payStripeNow=function(){Appointmentpro.StripeInstance.createToken($scope.cardElement).then(function(result){_stripeResponseHandler(result)})}
var _stripeResponseHandler=function(result){if(result.error){Dialog.alert("",result.error.message,"OK");$scope.is_loading=!1;$scope.isProcessing=!1;Loader.hide()}else{$scope.card={token:result.token.id,last4:result.token.card.last4,brand:result.token.card.brand,exp_month:result.token.card.exp_month,exp_year:result.token.card.exp_year,exp:Math.round(+(new Date((new Date(result.token.card.exp_year,result.token.card.exp_month,1))-1))/1000)|0};$scope.cart.stripe=$scope.card;$scope.placeOrder()}};$scope.range=function(min,max,step){step=step||1;var input=[];for(var i=min;i<=max;i+=step)input.push(i);return input}}).controller('AppointmentproPaypalReturnController',function(Dialog,Appointmentpro,SB,$ionicHistory,$ionicLoading,$location,Application,$ionicPlatform,$rootScope,$ionicScrollDelegate,Loader,$timeout,$ionicSlideBoxDelegate,Customer,$scope,$filter,$state,$stateParams,$translate,$ionicModal){$scope.value_id=Appointmentpro.value_id=$stateParams.value_id;Appointmentpro.cart=JSON.parse(Appointmentpro.get_local('PAYPAL_BEFORE_DATA'));Appointmentpro.unset_local('PAYPAL_BEFORE_DATA');$scope.cart=Appointmentpro.cart;Loader.show();$scope.updateBookingStatus=function(param){var booking_id=param.booking_id;Loader.show();Appointmentpro.updatePaymentStatus(param).then(function(data){if(param.status=='success'){Dialog.alert($translate.instant("Success","appointmentpro"),$translate.instant("Payment has been successfully","appointmentpro"),$translate.instant("OK","appointmentpro"),-1,"appointmentpro")}
if(param.status=='failed'){Dialog.alert($translate.instant("Error","appointmentpro"),$translate.instant("Payment has been failed","appointmentpro"),$translate.instant("OK","appointmentpro"),-1,"appointmentpro")}
$state.go("home",{value_id:$scope.value_id},{reload:!0}).then(function(){$state.go("appointmentpro-home",{value_id:$scope.value_id},{reload:!0}).then(function(){Loader.hide();$state.go("appointmentpro-booked-success",{value_id:$scope.value_id,booking_id:param.booking_id},{reload:!0})})})},function(error){Loader.hide();Dialog.alert($translate.instant("Error","appointmentpro"),error.message,$translate.instant("OK","appointmentpro"),-1,"appointmentpro")})}
$scope.loadContent=function(){Loader.show();if(Application.is_webview){var url=$location.absUrl();if(url.indexOf("?")>-1){var first_split=url.split('?');var second_split=first_split[1].split('&');if(second_split.length>1){var token_split=second_split[0].split('=');var tokenId=token_split[1];var payer_split=second_split[1].split('=');var payerId=payer_split[1];$scope.cart.status='success';$scope.cart.tokenId=tokenId;$scope.cart.payerId=payerId;Appointmentpro.cart=$scope.cart;$scope.updateBookingStatus($scope.cart)}else{$scope.cart.status='failed';$scope.cart.tokenId='';$scope.cart.payerId='';Appointmentpro.cart=$scope.cart;$scope.updateBookingStatus($scope.cart)}}}}
Application.loaded.then(function(){Loader.show();$scope.loadContent()})});angular.module('starter').controller('AppointmentproSuccessController',function(Dialog,Loader,$controller,Application,Customer,$session,Modal,$timeout,$translate,$rootScope,Appointmentpro,$scope,$state,$stateParams){angular.extend(this,$controller('AppointmentproCommanController',{Dialog:Dialog,$rootScope:$rootScope,$scope:$scope,$stateParams:$stateParams,Appointmentpro:Appointmentpro}));$scope.value_id=Appointmentpro.value_id=$stateParams.value_id;$scope.settings=Appointmentpro.getAppointmentproSettings();$scope.booking_id=$stateParams.booking_id;$scope.payout={};$scope.service_type='services';$scope.loadContent=function(){$scope.is_loading=!0;Appointmentpro.bookingDetails($scope.booking_id).success(function(data){$scope.payout=data;if($scope.payout.booking.is_it_class==1){$scope.service_type='classes'}
$scope.is_loading=!1}).error(function(error){$scope.is_loading=!1;Dialog.alert($translate.instant("Error","appointmentpro"),error.message,"OK",-1,"appointmentpro")}).finally(function(){$scope.$broadcast('scroll.infiniteScrollComplete')})};$scope.loadContent();$scope.goToBookingDetails=function(){$state.go("home",{value_id:$scope.value_id},{reload:!0}).then(function(){$state.go("appointmentpro-home",{value_id:$scope.value_id},{reload:!0}).then(function(){Loader.hide();$state.go("appointmentpro-booking",{value_id:$scope.value_id,type:'upcoming',service_type:$scope.service_type,booking_id:$scope.payout.booking.appointment_id},{reload:!0})})})}});angular.module('starter').controller('AppointmentproAccountController',function(Dialog,Loader,Application,$ionicSideMenuDelegate,Customer,$session,Modal,$ionicScrollDelegate,$timeout,$ionicModal,SB,$translate,$rootScope,Appointmentpro,$scope,$state,$stateParams,$controller,$compile){angular.extend(this,$controller('AppointmentproCommanController',{Dialog:Dialog,$rootScope:$rootScope,$scope:$scope,$stateParams:$stateParams,Appointmentpro:Appointmentpro}));$scope.value_id=Appointmentpro.value_id=$stateParams.value_id;$scope.settings=Appointmentpro.getAppointmentproSettings();$scope.payout={};$scope.is_logged_in=Customer.isLoggedIn();$scope.customer=Customer.customer;$scope.notification_setting={};$scope.customer_avatar=function(image){if(image!=''&&image!=null&&image!="null"){return IMAGE_URL+'images/customer'+image}else{return"./features/ewallet/assets/media/customer-placeholder.png"}};$scope.login=function(){if(!Customer.isLoggedIn()){Customer.loginModal($scope,function(){$timeout(function(){$scope.is_logged_in=Customer.isLoggedIn();$scope.customer=Customer.customer;$state.go('home').then(function(){$state.go("appointmentpro-home",{value_id:$scope.value_id},{reload:!0}).then(function(){$state.go("appointmentpro-account",{value_id:$scope.value_id},{reload:!0})})})},1000)})}else{Customer.loginModal()}}
$rootScope.$on(SB.EVENTS.AUTH.loginSuccess,function(){$scope.is_logged_in=Customer.isLoggedIn();$scope.customer=Customer.customer});$rootScope.$on(SB.EVENTS.AUTH.logoutSuccess,function(){$scope.is_logged_in=Customer.isLoggedIn();$scope.customer=Customer.customer});$scope.notificationSettings=function(){$scope.is_loading_modal=!0;Loader.show();$ionicModal.fromTemplateUrl('features/appointmentpro/assets/templates/modal/settings/notification_setttings.html',{scope:$scope,animation:'slide-in-right-left'}).then(function(modal){Appointmentpro.getNotificationSettings().success(function(data){$scope.notification_setting=data.setting;Loader.hide();$scope.is_loading_modal=!1}).error(function(error){Loader.hide();$scope.is_loading_modal=!1;Dialog.alert($translate.instant("Error","appointmentpro"),error.message,"OK",-1,"appointmentpro")});$scope.modalNotificationSettings=modal;$scope.modalNotificationSettings.show()})};$scope.closeModalNotificationSettings=function(){$scope.modalNotificationSettings.remove()}
$scope.updateNotificationSettings=function(){console.log($scope.notification_setting);Appointmentpro.customerNotificationSettings($scope.notification_setting).success(function(data){}).error(function(error){Dialog.alert($translate.instant("Error","appointmentpro"),error.message,"OK",-1,"appointmentpro")})}}).controller('AppointmentproAccountBookingController',function(Dialog,Loader,Application,$ionicSideMenuDelegate,Customer,$session,Modal,$ionicScrollDelegate,$timeout,$ionicModal,SB,$translate,$rootScope,Appointmentpro,$ionicPopup,$scope,$state,$stateParams,$controller,$compile){angular.extend(this,$controller('AppointmentproCommanController',{Dialog:Dialog,$rootScope:$rootScope,$scope:$scope,$stateParams:$stateParams,Appointmentpro:Appointmentpro}));$scope.value_id=Appointmentpro.value_id=$stateParams.value_id;$scope.type=$stateParams.type;$scope.service_type=$stateParams.service_type;$scope.booking_id=$stateParams.booking_id;$scope.settings=Appointmentpro.getAppointmentproSettings();$scope.payout={};$scope.bookingDetailsById=function(booking_id){$scope.is_loading_modal=!0;Loader.show();$ionicModal.fromTemplateUrl('features/appointmentpro/assets/templates/modal/booking/details.html',{scope:$scope,animation:'slide-in-right-left'}).then(function(modal){Appointmentpro.findBookingDetailsById(booking_id).success(function(data){$scope.booking_info=data.booking;Loader.hide();$scope.is_loading_modal=!1}).error(function(error){Loader.hide();$scope.is_loading_modal=!1;Dialog.alert($translate.instant("Error","appointmentpro"),error.message,"OK",-1,"appointmentpro");$scope.closeModalBookingDetails()});$scope.modalBookingDetails=modal;$scope.modalBookingDetails.show()})};$scope.closeModalBookingDetails=function(){$scope.modalBookingDetails.remove()}
$scope.loadContent=function(){$scope.is_loading=!0;Appointmentpro.findCustomerBooking($scope.type,$scope.service_type).success(function(data){$scope.payout=data;$scope.is_loading=!1}).error(function(error){$scope.is_loading=!1;Dialog.alert($translate.instant("Error","appointmentpro"),error.message,"OK",-1,"appointmentpro")}).finally(function(){$scope.$broadcast('scroll.infiniteScrollComplete')});if($scope.booking_id>0){$scope.bookingDetailsById($scope.booking_id)}};$scope.loadContent();$scope.cancelBooking=function(appointment_id){if($scope.booking_info.is_paid){var redund_amount=(((100-$scope.settings.cancellation_charges)*$scope.booking_info.total_amount)/100);var message=$translate.instant('Are you sure want to Cancel Booking?, You will get $1 in your account.',"appointmentpro");message=message.replace("$1",redund_amount)}else{var message=$translate.instant('Are you sure want to Cancel Booking?',"appointmentpro")}
$ionicPopup.show({title:$translate.instant('Confirm',"appointmentpro"),template:message,cssClass:'cancel-status',scope:$scope,buttons:[{text:$translate.instant('No',"appointmentpro"),type:'button-default',onTap:function(e){return!1}},{text:$translate.instant('Yes',"appointmentpro"),type:'button-positive',onTap:function(e){return!0}}]}).then(function(result){if(result){Loader.show();Appointmentpro.cancelBooking(appointment_id).then(function(data){Dialog.alert($translate.instant("Success","appointmentpro"),data.message,$translate.instant("OK","appointmentpro"));$scope.loadContent();$scope.closeModalBookingDetails()},function(error){Loader.hide();Dialog.alert($translate.instant("Error","appointmentpro"),error.message,$translate.instant("OK","appointmentpro"))}).then(function(){Loader.hide()})}})}
$scope.readInformation=function(content){$ionicModal.fromTemplateUrl('features/appointmentpro/assets/templates/modal/booking/information.html',{scope:$scope,animation:'slide-in-right-left'}).then(function(modal){$scope.content_details=$scope.settings.cancel_policy;$scope.modalReadInformation=modal;$scope.modalReadInformation.show()})};$scope.closeModalInformation=function(){$scope.modalReadInformation.remove()}});angular.module('starter').controller('AppointmentproClassesController',function(Dialog,Loader,Application,Customer,$session,Modal,$timeout,$translate,$ionicModal,$rootScope,Location,Appointmentpro,$scope,$state,$stateParams,$controller){angular.extend(this,$controller('AppointmentproCommanController',{Dialog:Dialog,$rootScope:$rootScope,$scope:$scope,$stateParams:$stateParams,Appointmentpro:Appointmentpro}));$scope.value_id=Appointmentpro.value_id=$stateParams.value_id;$scope.category_id=$stateParams.category_id;$scope.settings=Appointmentpro.getAppointmentproSettings();$scope.payout={};$scope.postParams={};$scope.loadContent=function(){$scope.postParams.category_id=$scope.category_id;$scope.is_loading=!0;Appointmentpro.findAllClasses($scope.postParams).success(function(data){$scope.payout=data;$scope.is_loading=!1}).error(function(error){$scope.is_loading=!1;Dialog.alert($translate.instant("Error","appointmentpro"),error.message,"OK",-1,"appointmentpro")})};$scope.getLocation=function(){if(Location.isEnabled){Location.getLocation({timeout:10000},!0).then(function(position){$scope.postParams.latitude=position.coords.latitude;$scope.postParams.longitude=position.coords.longitude;$scope.loadContent()},function(){$scope.postParams.latitude='';$scope.postParams.longitude='';$scope.requestLocation()})}else{$scope.postParams.latitude='';$scope.postParams.longitude='';$scope.requestLocation();$scope.loadContent()}}
$scope.requestLocation=function(){Location.requestLocation(function(){$scope.loadContent()},function(){$scope.loadContent()})}
$scope.$on("$ionicView.beforeEnter",function(event,data){$scope.getLocation()})}).controller('AppointmentproBookAClassController',function(Dialog,Loader,Application,$ionicSideMenuDelegate,Customer,$session,Modal,$ionicScrollDelegate,$timeout,$ionicModal,SB,$translate,$rootScope,Appointmentpro,$ionicPopup,$scope,$state,$stateParams,$controller,$compile){angular.extend(this,$controller('AppointmentproCommanController',{Dialog:Dialog,$rootScope:$rootScope,$scope:$scope,$stateParams:$stateParams,Appointmentpro:Appointmentpro}));$scope.value_id=Appointmentpro.value_id=$stateParams.value_id;$scope.cart=Appointmentpro.cart;$scope.settings=Appointmentpro.getAppointmentproSettings()});angular.module('starter').factory('Appointmentpro',function(Url,$rootScope,$pwaRequest,$session,$sbhttp,$q,Application,$location,$window){var factory={value_id:null,widget:null,cart:{},StripeInstance:null,publishable_key:null,settings:[],labels:[],isReadyPromise:$q.defer()};factory.setValueId=function(valueId){factory.value_id=valueId;return factory};factory.getValueId=function(){return factory.value_id};factory.isUndefined=function(thing){return(typeof thing==="undefined")}
factory.get_local=function(key){return $window.localStorage.getItem(key)||null}
factory.set_local=function(key,id){$window.localStorage.setItem(key,id)}
factory.unset_local=function(key){$window.localStorage.removeItem(key)}
factory.isUndefined=function(thing){return(typeof thing==="undefined")}
factory.setAppointmentproSettings=function(settings){factory.settings=settings;return factory};factory.getAppointmentproSettings=function(){return factory.settings};factory.setLabels=function(labels){factory.labels=labels;return factory};factory.getLabels=function(){return factory.labels};factory.findAll=function(params){return $pwaRequest.post('appointmentpro/mobile_view/findAll',{urlParams:{value_id:this.value_id,},data:params,cache:!1,refresh:!0})};factory.findAllLocations=function(params){return $pwaRequest.post('appointmentpro/mobile_location/findAll',{urlParams:{value_id:this.value_id,},data:params,cache:!1,refresh:!0})};factory.findLocationInfo=function(location_id){return $pwaRequest.post('appointmentpro/mobile_location/find',{urlParams:{value_id:this.value_id,location_id:location_id},cache:!1,refresh:!0})};factory.findLocationServiceByCategory=function(location_id,category_id){return $pwaRequest.post('appointmentpro/mobile_location/find-services-by-category',{urlParams:{value_id:this.value_id,location_id:location_id,category_id:category_id},cache:!1,refresh:!0})};factory.findCategoryByLocation=function(location_id){return $pwaRequest.post('appointmentpro/mobile_category/find-category-by-location',{urlParams:{value_id:this.value_id,location_id:location_id},cache:!1,refresh:!0})};factory.findServiceByLocationCategory=function(params){return $pwaRequest.post('appointmentpro/mobile_service/find-service-by-location-category',{urlParams:{value_id:this.value_id},data:{location_id:params.location_id,category_id:params.category_id},cache:!1,refresh:!0})};factory.findServiceProvider=function(params){return $pwaRequest.post('appointmentpro/mobile_provider/find-service-provider',{urlParams:{value_id:this.value_id},data:{location_id:params.location_id,service_id:params.service_id},cache:!1,refresh:!0})};factory.findProviderServices=function(params){return $pwaRequest.post('appointmentpro/mobile_service/find-service-by-provider-id',{urlParams:{value_id:this.value_id},data:{location_id:params.location_id,provider_id:params.provider_id},cache:!1,refresh:!0})};factory.availabletimeSlot=function(params,date){return $pwaRequest.post('appointmentpro/mobile_provider/find-service-provider-slot',{urlParams:{value_id:this.value_id},data:{location_id:params.location_id,service_id:params.service_id,provider_id:params.provider_id,category_id:params.category_id,date:date},cache:!1,refresh:!0})};factory.findConfirmBookingData=function(params){return $pwaRequest.post('appointmentpro/mobile_booking/find-info',{urlParams:{value_id:this.value_id},data:params,cache:!1,refresh:!0})};factory.findPaymentMethods=function(location_id){return $pwaRequest.post('appointmentpro/mobile_booking/find-payment-method',{urlParams:{value_id:this.value_id,location_id:location_id},cache:!1,refresh:!0})};factory.fetchSettings=function(){return $pwaRequest.post("/paymentstripe/mobile_cards/fetch-settings")};factory.bookingSubmit=function(params){params.is_webview=Application.is_webview;params.current_url=$location.url();params.BASE_PATH=BASE_PATH;return $pwaRequest.post('appointmentpro/mobile_booking/submit',{urlParams:{value_id:this.value_id},data:params,cache:!1,refresh:!0})};factory.bookingDetails=function(booking_id){return $pwaRequest.post('appointmentpro/mobile_booking/details',{urlParams:{value_id:this.value_id,booking_id:booking_id},cache:!1,refresh:!0})};factory.updatePaymentStatus=function(params){return $pwaRequest.post('appointmentpro/mobile_booking/update-payment-status',{urlParams:{value_id:factory.value_id,},data:params,refresh:!0})};factory.findCustomerBooking=function(type,service_type){return $pwaRequest.post('appointmentpro/mobile_account/find-customer-booking',{urlParams:{value_id:this.value_id,type:type,service_type:service_type},cache:!1,refresh:!0})};factory.findBookingDetailsById=function(booking_id){return $pwaRequest.post('appointmentpro/mobile_account/find-booking-by-id',{urlParams:{value_id:this.value_id,booking_id:booking_id},cache:!1,refresh:!0})};factory.customerNotificationSettings=function(params){return $pwaRequest.post('appointmentpro/mobile_account/customer-notification-settings',{urlParams:{value_id:this.value_id},data:params,cache:!1,refresh:!0})};factory.getNotificationSettings=function(){return $pwaRequest.post('appointmentpro/mobile_account/get-notification-settings',{urlParams:{value_id:this.value_id},cache:!1,refresh:!0})};factory.cancelBooking=function(appointment_id){return $pwaRequest.post('appointmentpro/mobile_account/cancel-booking',{urlParams:{value_id:this.value_id,appointment_id:appointment_id},cache:!1,refresh:!0})};factory.fetchAppointmentproSettings=function(appointment_id){return $pwaRequest.post('appointmentpro/mobile_view/fetch-font-settings',{urlParams:{value_id:this.getValueId(),},cache:!1,refresh:!0})};factory.findAllClasses=function(params){return $pwaRequest.post('appointmentpro/mobile_classes/findAll',{urlParams:{value_id:this.value_id,},data:params,cache:!1,refresh:!0})};factory.getClassInfo=function(class_id){return $pwaRequest.post('appointmentpro/mobile_classes/find',{urlParams:{value_id:this.value_id,class_id:class_id},cache:!1,refresh:!0})};factory.findLocationByCategoryId=function(category_id,params){return $pwaRequest.post('appointmentpro/mobile_location/find-location-by-category-id',{urlParams:{value_id:this.value_id,category_id:category_id},data:params,cache:!1,refresh:!0})};return factory});angular.module('starter').factory('AppointmentproInit',function(Application,Pages,Appointmentpro,$location,$stateParams,$timeout,$translate,$ionicHistory,$state,$session,Loader,$ionicSideMenuDelegate){var factory={};factory.loadAppointmentproWidget=function(parts){console.log('parts 2',parts);if(parts!==null&&parts.length===3){Loader.show($translate.instant('Loading...','appointmentpro'));$timeout(function(){console.log('parts 3',parts);Loader.hide();$ionicHistory.nextViewOptions({disableBack:!0});$ionicSideMenuDelegate.canDragContent(!1);$state.go('appointmentpro-home',{value_id:parts[1],widget:parts[2]})},100)}};factory.onStart=function(){var hash=HASH_ON_START.match(/\?__goto__=(.*)/);if(hash&&hash.length>=2){var path=hash[1];var parts=path.match(/\/appointmentpro\/([0-9]+)\/([0-9]+)/);if(parts!==null&&parts.length===3&&parts[2]=='213848'){factory.loadAppointmentproWidget(parts)}}
Application.loaded.then(function(){var appointmentpro=_.find(Pages.getActivePages(),{code:'appointmentpro'});if(!appointmentpro){return}
Appointmentpro.setValueId(appointmentpro.value_id).fetchAppointmentproSettings().then(function(data){Appointmentpro.setAppointmentproSettings(data.settings);Appointmentpro.setLabels(data.labels)})})}
return factory});Features.insertCSS(":root{--safe-area-inset-top:0;--safe-area-inset-right:0;--safe-area-inset-bottom:0;--safe-area-inset-left:0}@supports (padding-top:constant(safe-area-inset-top)){:root{--safe-area-inset-top:constant(safe-area-inset-top);--safe-area-inset-right:constant(safe-area-inset-right);--safe-area-inset-bottom:constant(safe-area-inset-bottom);--safe-area-inset-left:constant(safe-area-inset-left)}}@supports (padding-top:env(safe-area-inset-top)){:root{--safe-area-inset-top:env(safe-area-inset-top);--safe-area-inset-right:env(safe-area-inset-right);--safe-area-inset-bottom:env(safe-area-inset-bottom);--safe-area-inset-left:env(safe-area-inset-left)}}.platform-overview.platform-cordova{--safe-area-inset-top:1.5em;--safe-area-inset-right:0;--safe-area-inset-bottom:.5em;--safe-area-inset-left:0}.appointmentpro .remove-border{border:0}.appointmentpro .home-serach-list{width:100%;margin:0 10px}.appointmentpro .home-serach-item{padding-top:0}.appointmentpro .location-book-button{width:80%}.appointmentpro .location-time{font-size:12px}.appointmentpro .location-tabs{position:relative}.appointmentpro .location-image-grid{object-fit:cover}.appointmentpro .category-image-grid{border-radius:20%!important}.appointmentpro .service-image-grid{border-radius:20%!important}.appointmentpro .gallery-grid-img{width:100%;height:100%;object-fit:cover;border-radius:10%!important}.appointmentpro .book-button-details{margin-top:-40px;float:right;margin-right:10px;padding:0 25px 0}.appointmentpro .location-name{white-space:normal}.appointmentpro .providers-grid-img{width:100%;border-radius:50%}.appointmentpro .categories-grid-img{width:100%;height:100%;border-radius:10%}.appointmentpro .provider-image-circle{border-radius:50%}.appointmentpro .location-feature-img{max-height:250px}.appointmentpro-calendar #calendar{position:relative;overflow:hidden;width:100%;font-size:14px;cursor:pointer}.appointmentpro-calendar table{border-collapse:collapse;table-layout:fixed;width:100%;height:initial;position:relative;top:0;left:0;transform:translateX(0);transition:all 0.3s ease}.appointmentpro-calendar table.active{transform:translateX(0)}.appointmentpro-calendar table.inactive{transition:all 0.3s 0.01s ease}.appointmentpro-calendar table.hide-left{transform:translateX(-100vw)}.appointmentpro-calendar td,.appointmentpro-calendar th{text-align:center;background-color:#fff}.appointmentpro-calendar th{padding:5px}.appointmentpro-calendar tr:first-child th{font-size:20px;font-weight:700;border-left:none;border-top:none}.appointmentpro-calendar td:last-child,.appointmentpro-calendar th:last-child{border-right:none}.appointmentpro-calendar th{border-top:1px solid rgba(0,0,0,.1);border-right:1px solid rgba(0,0,0,.1);background-color:#4e4e4e;color:#fff;text-shadow:0 -1px 0 rgba(0,0,0,.2);font-weight:400}.appointmentpro-calendar th .any{font-size:12px;font-weight:400;display:block;text-shadow:none}.appointmentpro-calendar tr:nth-child(2) th{padding:5px}.appointmentpro-calendar td{padding:0;border-bottom:1px solid rgba(0,0,0,.05)}.appointmentpro-calendar tr>td{background-color:#e5e5e5}.appointmentpro-calendar td>span{color:#555;padding:10px;display:block;border:2px solid transparent;transition:border 0.3s ease;width:80%}.appointmentpro-calendar td:nth-child(even)>span{background-color:rgba(0,0,0,.02)}.appointmentpro-calendar #calendar td{padding:8px!important}.appointmentpro-calendar td.today{font-weight:700;background-color:#bfbfbf;color:#fff}.appointmentpro-calendar td.fora>span{opacity:.2}.appointmentpro-calendar td>span:hover{background:#a57cb6;color:#fff}.appointmentpro-calendar .boto-next{right:5px!important}.appointmentpro-calendar .boto-prev{left:5px!important}.appointmentpro-calendar .boto-next,.appointmentpro-calendar .boto-prev{color:transparent;background:transparent;border:0;width:34px!important;height:34px!important;position:absolute!important;float:left;top:5px!important}.appointmentpro-calendar .boto-next:after{content:'';position:absolute;display:block;right:12px;top:20px;width:12px;height:12px;border:solid #fff;border-width:4px 4px 0 0;transform:rotate(45deg);cursor:pointer}.appointmentpro-calendar .boto-prev:after{content:'';position:absolute;display:block;left:12px;top:20px;width:12px;height:12px;border:solid #fff;border-width:0 0 4px 4px;transform:rotate(45deg);cursor:pointer}.appointmentpro-calendar td.previous{opacity:.4}","appointmentpro")